from openai import OpenAI

from src.utils import get_openai_api_key


def get_gpt_response(client, messages):
    response = client.chat.completions.create(
        model = 'gpt-4o-mini',
        temperature = 0.9,
        messages = messages
    )
    return response.choices[0].message.content

def main():
    # 초기 메시지 템플릿
    messages = [
        {'role': 'system', 'content': '너는 아주 뛰어난 비서야.'}
    ]

    # OpenAI 클라이언트 생성
    client = OpenAI(api_key=get_openai_api_key())

    while True:
        # 콘솔에서 사용자 입력을 받음.
        user_input = input('사용자>>> ')
        if user_input == 'exit':
            break

        # 사용자가 입력한 텍스트를 user 역할 메시지 content로 메시지 템플릿에 추가.
        messages.append({'role': 'user', 'content': user_input})

        # GPT 채팅 요청을 보내고, GPT가 생성한 답변을 받음.
        response = get_gpt_response(client, messages)

        # GPT가 생성한 답변을 출력
        print('MyGPT>>>', response)

        # GPT 생성한 답변을 다음 질문 이전의 프롬프트로 사용하기 위해서 messages에 추가.
        messages.append({'role': 'assistant', 'content': response})

if __name__ == '__main__':
    main()


```
<결과>
C:\workspace\lab_llm\.venv\Scripts\python.exe C:\workspace\lab_llm\src\lab03\multi_turn.py 
사용자>>> 야구 좋아해
MyGPT>>> 네, 야구는 많은 사람들에게 사랑받는 스포츠입니다! 좋아하는 팀이나 선수는 있으신가요? 아니면 야구에 대해 궁금한 점이 있으신가요?
사용자>>> 어떤 투수가 잘해?
MyGPT>>> 투수의 성과는 시즌, 팀, 리그에 따라 다르지만, 몇몇 투수들은 꾸준히 뛰어난 활약을 보입니다. 예를 들어, 최근 몇 년간 주목받는 투수들로는 조지 킹(George Kirby), 게릿 콜(Gerrit Cole), 혹은 더스틴 메이(Dustin May) 같은 선수들이 있습니다. 특정 리그나 시즌에 따라 더 많은 선수들이 있을 수 있으니, 어떤 점에 대해 더 알고 싶으신가요?
사용자>>> 한국에서
MyGPT>>> 한국 프로야구(KBO 리그)에서 뛰어난 투수들은 많이 있습니다. 최근 몇 년간 두각을 나타낸 투수들 중 일부는:

1. **양현종** - KIA 타이거즈의 에이스로, 여러 차례 정규 시즌 MVP와 사이영상 후보에 올랐습니다.
2. **이용찬** - LG 트윈스의 투수로, 안정된 피칭으로 팀의 중요한 역할을 하고 있습니다.
3. **정우영** - 최근 몇 년간 두각을 나타낸 젊은 투수로, 뛰어난 볼구속과 구질로 주목받고 있습니다.
4. **최원준** - 최근 시즌에서 좋은 성적을 올린 유망주로 평가받고 있습니다.

각 시즌마다 다양한 투수들이 부상과 컨디션에 따라 활약이 달라질 수 있으니, 최근 성적이나 기록을 참고하면 더 좋은 정보를 얻을 수 있습니다. 특정 선수에 대해 더 궁금한 점이 있다면 말씀해 주세요!
사용자>>> 타자
MyGPT>>> 한국 프로야구(KBO 리그)에서 뛰어난 타자들은 많이 있습니다. 최근 몇 년간 두각을 나타낸 몇몇 타자들은 다음과 같습니다:

1. **이정후** (키움 히어로즈) - 뛰어난 타격과 주력으로 주목받는 유망한 선수로, MVP 후보로 자주 언급됩니다.
2. **김재환** (두산 베어스) - 파워 히터로 알려져 있으며, 홈런과 타점을 많이 기록하는 선수입니다.
3. **최정** (SK 와이번스) - 꾸준한 타격과 장타력을 가진 선수로, KBO 리그에서 오랜 시간 동안 활약해왔습니다.
4. **박병호** (키움 히어로즈) - KBO 리그에서 여러 차례 홈런왕에 오른 경험이 있는 베테랑 타자입니다.

이 외에도 많은 유망한 타자가 있으니 시즌마다 다양한 선수들이 두각을 나타냅니다. 혹시 특정 선수에 대해 더 알고 싶으신 부분이 있다면 말씀해 주세요!
사용자>>> MLB는
MyGPT>>> 메이저 리그 베이스볼(MLB)에서도 뛰어난 타자들이 많습니다. 최근 몇 년 간 주목받는 몇몇 선수들은 다음과 같습니다:

1. **쇼헤이 오타니** (LA 에인절스) - 투수와 타자로서 뛰어난 성적을 거두며, 역사적인 선수로 평가받고 있습니다. 그는 강력한 파워와 정교한 타격 능력을 겸비한 선수입니다.

2. **타티스 주니어** (샌디에이고 파드리스) - 젊고 재능 있는 단타자로, 아주 빠른 스피드와 뛰어난 파워를 자랑합니다.

3. **마이크 트라웃** (LA 에인절스) - 리그 최고의 선수 중 한 명으로, 뛰어난 타격 능력과 주루 능력을 지닌 선수입니다.

4. **호세 알투베** (휴스턴 애스트로스) - 다년간 뛰어난 성적을 올린 경험 많은 타자입니다. 타격과 주루에서 모두 뛰어난 능력을 보여줍니다.

5. **프레디 프리먼** (로스앤젤레스 다저스) - 전 애틀랜타 브레이브스 소속으로 MVP를 수상한 경험이 있는 베테랑 타자입니다.

이 외에도 MLB에는 뛰어난 타자들이 많으며, 각 시즌마다 새로운 스타들이 등장하기도 합니다. 특정 선수에 대해 더 궁금한 점이 있으신가요?
사용자>>> exit

종료 코드 0(으)로 완료된 프로세스
```
