# Imports

```python
import numpy as np
import matplotlib.pyplot as plt

from sklearn import datasets
from sklearn.linear_model import SGDClassifier
from sklearn.model_selection import cross_validate, train_test_split
from sklearn.metrics import accuracy_score

import tensorflow as tf
import keras
```

# Iris 데이터 셋

```python
data, target = datasets.load_iris(return_X_y = True)
```

## 4개 특성을 모두 사용한 다중 클래스 분류 - SGD

```python
data.shape    # (150 samples, 4 features). (행, 열)
```
<img width="67" height="34" alt="image" src="https://github.com/user-attachments/assets/ae2dc101-3c99-445c-aef1-334e010912e1" />

```python
data[:5]
```
<img width="211" height="95" alt="image" src="https://github.com/user-attachments/assets/1c08e087-0ba7-4a35-a3cb-0addf50e0ec8" />

```python
target.shape    # (150 labels)
```
<img width="55" height="30" alt="image" src="https://github.com/user-attachments/assets/0fae80e6-dfe2-4964-9514-edcaef46712f" />

```python
np.unique(target, return_counts = True)
```
<img width="289" height="30" alt="image" src="https://github.com/user-attachments/assets/c9d25844-1f52-4f0e-8727-66ada4fa4f4d" />

```python
sgd = SGDClassifier(loss = 'log_loss', random_state = 42)   # 손실 함수를 로그 손실로 설정
```
```python
sgd.fit(X = data, y = target)
```
<img width="355" height="75" alt="image" src="https://github.com/user-attachments/assets/7a3cd2d4-3369-46b9-8ecf-d3db2defdfa9" />

```python
sgd.intercept_  # 절편 (총 3개의 클래스)
```
<img width="376" height="31" alt="image" src="https://github.com/user-attachments/assets/c6273775-e5a5-491f-886a-e338c4cee011" />

```python
sgd.coef_   # 가중치
```
<img width="498" height="66" alt="image" src="https://github.com/user-attachments/assets/9a029c25-2e3e-4226-985c-5170809b55d1" />

```python
pred = sgd.predict(X = data)
pred
```
<img width="525" height="133" alt="image" src="https://github.com/user-attachments/assets/64ed2a8d-78e2-4344-b671-bd3123ac11bc" />

```python
accuracy_score(target, pred)
```
<img width="43" height="33" alt="image" src="https://github.com/user-attachments/assets/cc4790c4-5e0e-4a25-a19c-c57dea26bab5" />

# 4개 특성을 모두 사용한 다중 클래스 분류 - 신경망

```python
model = keras.Sequential()  # Sequential(완전 연결 신경망) 생성
```
```python
model.add(keras.layers.Input(shape = (4,)))     # 신경망에 입력층 추가. 4개의 특성을 가진 1차원 배열
model.add(keras.layers.Dense(units = 3, activation = 'softmax'))    # 신경망에 출력층 추가. 출력 노드 개수 3개
# 다중 클래스 분류에서 활성화 함수는 softmax!
# softmax는 3개의 출력 값을 각 클래스에 속할 확률로 변환해주는 역할. 모든 확률의 합은 항상 1
```
```python
model.summary()
```
<img width="604" height="164" alt="image" src="https://github.com/user-attachments/assets/9a8390c5-8497-4d4b-a2c8-f0a04f93cf32" />

```python
# 모델 컴파일
model.compile(optimizer = keras.optimizers.SGD(),
              loss = keras.losses.sparse_categorical_crossentropy,
              metrics = [keras.metrics.sparse_categorical_accuracy])
```
```python
# 모델 훈련
model.fit(x = data, y = target, epochs = 1_000, verbose = 0)
```
<img width="403" height="35" alt="image" src="https://github.com/user-attachments/assets/f733f9cc-0c0d-4bfa-88b3-454b939d18ec" />

```python
# 모델 훈련 후 신경망이 찾은 모델 파라미터(가중치, weights)
model.weights
```
<img width="630" height="131" alt="image" src="https://github.com/user-attachments/assets/81bb0125-be52-4e11-b98d-a3b5961f623e" />

```python
predicts = model.predict(x = data)
```
<img width="1252" height="62" alt="image" src="https://github.com/user-attachments/assets/bbe905e9-32d2-4bc2-953b-d8c24a1d68b9" />

```python
predicts.shape
```
<img width="67" height="27" alt="image" src="https://github.com/user-attachments/assets/ab388232-b05b-4477-a652-c41b10c28a11" />

```python
predicts[:5]
```
<img width="499" height="102" alt="image" src="https://github.com/user-attachments/assets/4f033be3-3ee4-4a9a-89fc-919380f1868e" />

```python
predicts[-5:]
```
<img width="498" height="97" alt="image" src="https://github.com/user-attachments/assets/b7938a6e-d6a1-4f90-b7ed-884066bb0439" />

```python
model.evaluate(x = data, y = target)
```
<img width="794" height="44" alt="image" src="https://github.com/user-attachments/assets/83a8e67d-756c-4e02-bdbd-7d7c5b31ebc2" />

--------

# Fashion MNIST 이미지 분류

# Imports

```python
import numpy as np
import matplotlib.pyplot as plt

import tensorflow as tf
import keras

from sklearn.model_selection import train_test_split
from sklearn.linear_model import SGDClassifier
from sklearn.metrics import accuracy_score
```
```python
tf.__version__
```
<img width="68" height="28" alt="image" src="https://github.com/user-attachments/assets/da43b631-0b9c-4f16-8172-fb0edbebaf25" />

```python
keras.__version__
```
<img width="68" height="28" alt="image" src="https://github.com/user-attachments/assets/98064ccf-1204-4702-944c-b620fb813908" />

```python
print(keras.config.backend())  # Keras 라이브러리에서 신경망 계산을 할 때 필요한 라이브러리.
```
<img width="87" height="29" alt="image" src="https://github.com/user-attachments/assets/6e1ebcf1-568c-4414-8609-3e926b1fc4a2" />

```python
print(tf.config.list_physical_devices())  # CPU/GPU/TPU 사용 여부 확인
```
<img width="942" height="31" alt="image" src="https://github.com/user-attachments/assets/e41ce162-bc15-479e-a802-4fe59e349d0f" />

```
Keras 라이브러리는 GPU 연산을 직접 수행하지 않음. 대신에 GPU 연산을 수행하는 다른 딥러닝 라이브러리를 백엔드(backend)로 활용함.

*   Keras에서 사용할 수 있는 백엔드 종류
    *   TensorFlow - Google에서 만든 텐서(Tensor) 연산을 빠르게 수행하기 위한 라이브러리.
    *   PyTorch - Meta(페이스북)에서 만든 딥러닝 라이브러리 -> 리눅스 재단으로 오픈소스로 공개.
*   Keras
    *   여러가지 백엔드를 사용해서 신경망을 쉽게 만들고 사용할 수 있도록 만든 고급 라이브러리.
    *   2.3.1 버전 이후부터는 TensorFlow만 단일 백엔드로 사용하도록 기능 변경.
    *   3.0 버전부터 다시 멀티 백엔드 정책으로 바뀜.
```

# Fashion MNIST 데이터 셋

```
10가지 패션 아이템의 28x28 크기의 흑백 이미지 60,000개 훈련 셋/레이블, 10,000개 테스트 셋/레이블.
```

```python
(x_train, y_train), (x_test, y_test) = keras.datasets.fashion_mnist.load_data()
# (훈련 셋, 훈련 레이블), (테스트 셋, 테스트 레이블)
```
<img width="783" height="149" alt="image" src="https://github.com/user-attachments/assets/f4671844-ed1a-48a1-a108-54b95ed04e86" />

```python
x_train.shape  # (n_samples, image_width, image_height)
```
<img width="117" height="28" alt="image" src="https://github.com/user-attachments/assets/39eb06f3-ec1b-42ee-a564-23555e50ef42" />

```python
y_train.shape
```
<img width="68" height="32" alt="image" src="https://github.com/user-attachments/assets/30c615a9-c0b8-4539-abca-d52542a52223" />

```python
np.unique(y_train, return_counts=True)    # 0 ~ 9 총 10개의 클래스. 각 레이블의 개수는 6000개
```
<img width="505" height="50" alt="image" src="https://github.com/user-attachments/assets/1fb8f71c-f3e3-4348-927e-40a174dbedae" />

```python
x_test.shape
```
<img width="112" height="28" alt="image" src="https://github.com/user-attachments/assets/a79de288-1668-44a2-b6de-510b7a0fa2d6" />

```python
np.unique(y_test, return_counts=True)
```
<img width="491" height="45" alt="image" src="https://github.com/user-attachments/assets/866faa7d-56c3-403a-8878-a71d41e649a1" />

```
훈련셋, 테스트셋 모두 각 클래스의 샘플들이 동일한 개수로 만들어져 있음.
```
```
데이터셋의 이미지를 시각화해 보세요.
```
```python
def plot_fashion_mnist(arr, ncols = 10):
    # arr: (samples, width, height) shape의 3차원 배열
    # ncols: subplot axis의 컬럼 개수.
    n = len(arr)    # 출력할 이미지 개수
    nrows = int(np.ceil(n / ncols))     # subplot Axis 행 개수.
    fig, ax = plt.subplots(nrows, ncols, figsize = (ncols, nrows))
    for i in range(nrows):
        for j in range(ncols):
            idx = i * ncols + j     # arr에서 선택할 이미지 인덱스.
            if nrows == 1 or ncols == 1:    # ax가 1차원 배열인 경우
                if idx < n:
                    ax[idx].imshow(arr[idx], cmap = plt.cm.binary)
                ax[idx].axis('off')
            else:   # ax가 2차원 배열인 경우
                if idx < n:
                    ax[i, j].imshow(arr[idx], cmap = plt.cm.binary)
                ax[i, j].axis('off')
    plt.show()
```
```python
plot_fashion_mnist(x_train[:10])
```
<img width="794" height="85" alt="image" src="https://github.com/user-attachments/assets/7eb81933-f961-4582-8540-c29a990fffa1" />

```python
plot_fashion_mnist(x_train[:45])
```
<img width="794" height="404" alt="image" src="https://github.com/user-attachments/assets/1f5b2f7a-54c0-443b-9eb6-5e6d214eecce" />

# 훈련 셋/레이블을 훈련 셋과 검증 셋으로 분리

```python
train_data, val_data, train_target, val_target = \
        train_test_split(x_train, y_train, random_state = 42, test_size = 0.2, stratify = y_train)
# \는 여러 줄로 나누어 작성할 때 사용하는 기호
```
```python
print(train_data.shape)
print(train_target.shape)
print(np.unique(train_target, return_counts = True))
```
<img width="864" height="66" alt="image" src="https://github.com/user-attachments/assets/ebdeccd9-7560-400f-918d-39547a6b3e1e" />

```python
print(val_data.shape)
print(val_target.shape)
print(np.unique(val_target, return_counts = True))
```
<img width="859" height="63" alt="image" src="https://github.com/user-attachments/assets/2225ed09-eaf6-48d8-9d5c-b18d8b84ca40" />

# SGD Classifier

```python
train_data[0]   # 각 픽셀의 값들이 0(white) ~ 255(white)
```
ndarray (28, 28) 
<img width="28" height="28" alt="image" src="https://github.com/user-attachments/assets/2a1ce3c3-5338-42bf-8043-5dd7aaa29dfb" />

```python
# 훈련 셋의 픽셀 값을 0 ~ 1 사이의 값으로 스케일링 -> 확률적 경사 하강법 성능을 높이기 위해서.
train_data_scaled = train_data / 255.0
```
```python
train_data_scaled[0]
```
```
array([[0.        , 0.        , 0.        , 0.        , 0.00392157,
        0.00392157, 0.        , 0.        , 0.        , 0.09803922,
        0.21568627, 0.        , 0.        , 0.        , 0.        ,
        0.        , 0.        , 0.16862745, 0.09411765, 0.        ,
        0.        , 0.        , 0.00392157, 0.        , 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.00392157, 0.00392157,
        0.00392157, 0.        , 0.09803922, 0.57647059, 0.74117647,
        0.70980392, 0.37647059, 0.2       , 0.19215686, 0.21568627,
        0.14509804, 0.29803922, 0.85098039, 0.6745098 , 0.49019608,
        0.07843137, 0.        , 0.00784314, 0.00392157, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.00392157, 0.01176471,
        0.        , 0.32156863, 0.80784314, 0.79215686, 0.74509804,
        0.69803922, 0.7372549 , 0.9372549 , 0.59607843, 0.38823529,
        0.78039216, 0.78823529, 0.63529412, 0.69019608, 0.75294118,
        0.7254902 , 0.27843137, 0.        , 0.00784314, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.00392157, 0.        ,
        0.        , 0.79215686, 0.76862745, 0.70980392, 0.7372549 ,
        0.71764706, 0.6627451 , 0.70196078, 0.62745098, 0.41960784,
        0.77647059, 0.65098039, 0.65490196, 0.69803922, 0.66666667,
        0.71764706, 0.65098039, 0.        , 0.        , 0.00392157,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.00392157, 0.        ,
        0.18823529, 0.84705882, 0.72156863, 0.7254902 , 0.7254902 ,
        0.74509804, 0.68627451, 0.64313725, 0.7372549 , 0.77647059,
        0.7372549 , 0.61568627, 0.71764706, 0.69019608, 0.67058824,
        0.65490196, 0.68627451, 0.10196078, 0.        , 0.00784314,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.        ,
        0.35294118, 0.87843137, 0.71764706, 0.7254902 , 0.72156863,
        0.71764706, 0.74509804, 0.64313725, 0.6627451 , 0.75686275,
        0.61960784, 0.66666667, 0.68235294, 0.69019608, 0.68627451,
        0.64705882, 0.70588235, 0.24313725, 0.        , 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.        ,
        0.48235294, 0.89411765, 0.72156863, 0.70588235, 0.71764706,
        0.69803922, 0.71764706, 0.6745098 , 0.6745098 , 0.6745098 ,
        0.63137255, 0.70196078, 0.66666667, 0.68235294, 0.68627451,
        0.64705882, 0.70980392, 0.41568627, 0.        , 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.        ,
        0.61176471, 0.89803922, 0.7372549 , 0.68627451, 0.69803922,
        0.68627451, 0.68627451, 0.74509804, 0.61568627, 0.61568627,
        0.70588235, 0.6627451 , 0.6627451 , 0.6745098 , 0.67058824,
        0.63137255, 0.70196078, 0.56078431, 0.        , 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.        ,
        0.70980392, 0.89411765, 0.74509804, 0.68235294, 0.68235294,
        0.69019608, 0.68627451, 0.77254902, 0.65490196, 0.65490196,
        0.71764706, 0.65098039, 0.6627451 , 0.67058824, 0.66666667,
        0.63529412, 0.68627451, 0.6745098 , 0.        , 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.02352941,
        0.68627451, 0.86666667, 0.75294118, 0.66666667, 0.68235294,
        0.69019608, 0.68627451, 0.75686275, 0.69019608, 0.6745098 ,
        0.68627451, 0.65490196, 0.6627451 , 0.6627451 , 0.65490196,
        0.62745098, 0.6627451 , 0.76862745, 0.        , 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.09019608,
        0.72156863, 0.84705882, 0.80784314, 0.64313725, 0.68627451,
        0.69019608, 0.68627451, 0.75294118, 0.69803922, 0.68627451,
        0.68235294, 0.65490196, 0.65098039, 0.6627451 , 0.6627451 ,
        0.64705882, 0.6627451 , 0.68627451, 0.02352941, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.20784314,
        0.74117647, 0.81568627, 0.85882353, 0.63137255, 0.69019608,
        0.69019608, 0.68627451, 0.74509804, 0.70980392, 0.69803922,
        0.6745098 , 0.6627451 , 0.64705882, 0.66666667, 0.6627451 ,
        0.65098039, 0.65490196, 0.71764706, 0.10196078, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.32941176,
        0.76078431, 0.81176471, 0.84705882, 0.61568627, 0.69019608,
        0.68627451, 0.69019608, 0.75686275, 0.71764706, 0.70588235,
        0.6745098 , 0.65490196, 0.65490196, 0.65098039, 0.66666667,
        0.64705882, 0.65490196, 0.7254902 , 0.23921569, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.44705882,
        0.75686275, 0.82745098, 0.81176471, 0.61568627, 0.68627451,
        0.68627451, 0.69019608, 0.76862745, 0.71764706, 0.70980392,
        0.6745098 , 0.65098039, 0.65098039, 0.64705882, 0.66666667,
        0.64313725, 0.6627451 , 0.73333333, 0.34509804, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.60784314,
        0.75294118, 0.85882353, 0.76078431, 0.63137255, 0.6745098 ,
        0.69803922, 0.69019608, 0.77254902, 0.7254902 , 0.70980392,
        0.6627451 , 0.65098039, 0.64705882, 0.64705882, 0.67058824,
        0.64313725, 0.67058824, 0.72156863, 0.42352941, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.70980392,
        0.75294118, 0.88235294, 0.7254902 , 0.63529412, 0.6745098 ,
        0.70196078, 0.69019608, 0.78039216, 0.7254902 , 0.71764706,
        0.6627451 , 0.65098039, 0.64313725, 0.64313725, 0.6745098 ,
        0.63137255, 0.66666667, 0.72156863, 0.52941176, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.82352941,
        0.74117647, 0.91372549, 0.70588235, 0.63137255, 0.67058824,
        0.70196078, 0.70196078, 0.78823529, 0.7254902 , 0.74509804,
        0.65098039, 0.65098039, 0.64313725, 0.64313725, 0.69019608,
        0.61960784, 0.67058824, 0.71764706, 0.60784314, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.89803922,
        0.72156863, 0.91764706, 0.69019608, 0.64313725, 0.6627451 ,
        0.70588235, 0.71764706, 0.77647059, 0.7254902 , 0.75686275,
        0.65098039, 0.65490196, 0.64313725, 0.64705882, 0.70196078,
        0.61568627, 0.69019608, 0.70196078, 0.68235294, 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.00784314, 0.92941176,
        0.71764706, 0.92941176, 0.67058824, 0.65098039, 0.65490196,
        0.69803922, 0.7372549 , 0.76862745, 0.73333333, 0.76862745,
        0.64313725, 0.65098039, 0.64705882, 0.65098039, 0.70196078,
        0.61568627, 0.69803922, 0.69019608, 0.7254902 , 0.00784314,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.09411765, 0.96470588,
        0.72156863, 1.        , 0.6745098 , 0.65098039, 0.6627451 ,
        0.70588235, 0.75294118, 0.76862745, 0.74117647, 0.78823529,
        0.63137255, 0.64313725, 0.64705882, 0.64705882, 0.70980392,
        0.63137255, 0.70980392, 0.69019608, 0.74117647, 0.06666667,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.20392157, 0.96862745,
        0.73333333, 0.93333333, 0.65098039, 0.66666667, 0.66666667,
        0.70588235, 0.77647059, 0.75686275, 0.74117647, 0.81176471,
        0.62745098, 0.64705882, 0.64705882, 0.64313725, 0.70588235,
        0.63529412, 0.73333333, 0.68627451, 0.75294118, 0.20392157,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.32156863, 0.84313725,
        0.75294118, 0.9372549 , 0.61960784, 0.6627451 , 0.68235294,
        0.70196078, 0.81176471, 0.74117647, 0.73333333, 0.83529412,
        0.62745098, 0.65490196, 0.65098039, 0.64705882, 0.70980392,
        0.6627451 , 0.74509804, 0.66666667, 0.75294118, 0.28627451,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.4       , 0.83137255,
        0.78823529, 0.83137255, 0.65098039, 0.6627451 , 0.67058824,
        0.70196078, 0.85098039, 0.74117647, 0.73333333, 0.85098039,
        0.61568627, 0.66666667, 0.65490196, 0.65098039, 0.69803922,
        0.67058824, 0.76862745, 0.6627451 , 0.67058824, 0.32941176,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.65098039, 0.82745098,
        0.83529412, 0.75686275, 0.64313725, 0.66666667, 0.66666667,
        0.70588235, 0.88627451, 0.70980392, 0.73333333, 0.89411765,
        0.61568627, 0.65490196, 0.65490196, 0.61960784, 0.7372549 ,
        0.76862745, 0.50196078, 0.66666667, 0.70196078, 0.50196078,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.1372549 , 0.36078431,
        0.50588235, 0.78039216, 0.72156863, 0.67058824, 0.70196078,
        0.73333333, 0.96470588, 0.66666667, 0.74117647, 0.94117647,
        0.61176471, 0.66666667, 0.68235294, 0.65098039, 0.74509804,
        0.90196078, 0.54509804, 0.4       , 0.54509804, 0.34901961,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.        ,
        0.        , 0.55686275, 0.83529412, 0.65098039, 0.59215686,
        0.69803922, 0.92156863, 0.74509804, 0.63529412, 0.95686275,
        0.70196078, 0.71764706, 0.62745098, 0.55686275, 0.64313725,
        0.81568627, 0.49019608, 0.        , 0.        , 0.        ,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.00392157,
        0.00784314, 0.        , 0.37647059, 0.70980392, 0.70196078,
        0.69803922, 0.69803922, 0.7254902 , 0.62745098, 0.81568627,
        0.67058824, 0.65490196, 0.65490196, 0.72156863, 0.68235294,
        0.41176471, 0.        , 0.00392157, 0.00784314, 0.00392157,
        0.        , 0.        , 0.        ],
       [0.        , 0.        , 0.        , 0.        , 0.        ,
        0.        , 0.00784314, 0.        , 0.00392157, 0.20392157,
        0.3254902 , 0.38431373, 0.43921569, 0.5254902 , 0.57254902,
        0.41176471, 0.34901961, 0.28627451, 0.19215686, 0.        ,
        0.        , 0.        , 0.        , 0.        , 0.        ,
        0.        , 0.        , 0.        ]])
```
```python
sgd = SGDClassifier(loss = 'log_loss', random_state=42, n_jobs = -1)
```
```python
sgd.fit(X = train_data_scaled.reshape((48_000, -1)), y = train_target)
# 48000개의 샘플로 각 샘플을 1차원 배열로 펼치는 것
```
<img width="430" height="74" alt="image" src="https://github.com/user-attachments/assets/2efc5b16-54cd-47fd-8856-bcf45233ba29" />

```python
sgd.intercept_  # shape: (10,)
```
<img width="446" height="60" alt="image" src="https://github.com/user-attachments/assets/4124fcc8-3707-4017-b174-d4f855a5c96f" />

```python
sgd.coef_.shape     # (10, 784)
```
<img width="72" height="30" alt="image" src="https://github.com/user-attachments/assets/07a16847-39e1-4094-b4e1-fdb2784ce706" />

```python
predict_probas = sgd.predict_proba(X = train_data_scaled.reshape((48_000, -1)))
```
```python
predict_probas.shape    #> (48_000, 10)
```
<img width="87" height="27" alt="image" src="https://github.com/user-attachments/assets/37fee5b4-aa55-440c-9f9a-aaaa4b51d77f" />

```python
predict_probas[:5]
```
```
array([[1.20888251e-02, 1.05549631e-05, 2.30094285e-01, 3.41231387e-03,
        4.86284532e-02, 3.96063160e-10, 6.91742929e-01, 1.54454383e-17,
        1.40226378e-02, 1.05805064e-16],
       [7.53889861e-01, 1.20438290e-04, 4.89841116e-05, 2.88644150e-04,
        7.52168267e-02, 4.15812599e-17, 1.69806662e-01, 2.22627871e-15,
        6.28584469e-04, 3.41774283e-15],
       [2.89450403e-03, 2.51542365e-04, 1.32250305e-04, 9.78121334e-01,
        2.43557068e-04, 8.15414752e-12, 1.83430550e-02, 1.32044303e-06,
        1.24368179e-05, 1.15226778e-10],
       [1.87927047e-02, 1.53865511e-02, 4.75084700e-03, 9.59873842e-01,
        2.15421676e-04, 2.30937550e-07, 4.85837345e-04, 7.79498173e-08,
        4.94463323e-04, 2.39574997e-08],
       [9.71611164e-01, 8.55700455e-07, 2.35430174e-03, 2.77866962e-07,
        7.27359445e-06, 2.50343665e-19, 2.58251753e-02, 6.13245802e-16,
        2.00951140e-04, 2.02813751e-10]])
```
```python
predicts = sgd.predict(X = train_data_scaled.reshape((48_000, -1)))
```
```python
predicts.shape      # (48_000,)
```
<img width="64" height="29" alt="image" src="https://github.com/user-attachments/assets/034fb0f9-0fac-4110-b862-de80afbfe910" />

```python
predicts[:5]
```
<img width="268" height="31" alt="image" src="https://github.com/user-attachments/assets/89b1f025-7350-43af-973c-673c70399f5f" />

```python
accuracy_score(train_target, predicts)      # 훈련 셋 정확도
```
<img width="79" height="26" alt="image" src="https://github.com/user-attachments/assets/51fc3f93-8005-434c-8e10-fd10bd65f78e" />

```python
# 검증 셋의 모든 픽셀을 0 ~ 1 사이로 스케일링
val_data_scaled = val_data / 255.0
# 검증 셋의 예측값
val_predicts = sgd.predict(X = val_data_scaled.reshape((12_000, -1)))
# 검증 셋의 정확도
accuracy_score(y_true = val_target, y_pred = val_predicts)
```
<img width="145" height="29" alt="image" src="https://github.com/user-attachments/assets/90c66502-41f6-4407-90ce-34c6be3a43c8" />

# 신경망

Keras 라이브러리를 사용해서 입력층과 출력층만 갖는 신경망을 만들고 테스트하세요.

```python
tr_data_scaled_flat = train_data_scaled.reshape((48_000, -1))
val_data_scaled_flat = val_data_scaled.reshape((12_000, -1))
```
```python
print(tr_data_scaled_flat.shape)
print(val_data_scaled_flat.shape)
```
<img width="104" height="44" alt="image" src="https://github.com/user-attachments/assets/000cdded-01ea-4f7f-9a0c-57a56025796f" />

```python
inputs = keras.layers.Input(shape = (784,))     # 입력층
```
```python
dense = keras.layers.Dense(units = 10, activation = 'softmax')      # 출력층
```
```python
model = keras.Sequential(layers = [inputs, dense])      # 완전 연결 신경망
```
```python
model.summary()
#> 모델 파라미터 개수 = (784 weight * 10 output) + 10 bias =  7,850
```
<img width="610" height="167" alt="image" src="https://github.com/user-attachments/assets/a113dcc5-7483-4512-96ba-b74a73b093b4" />

```python
model.compile(loss=keras.losses.sparse_categorical_crossentropy,
              metrics=[keras.metrics.sparse_categorical_accuracy])
```
```python
model.fit(x=tr_data_scaled_flat, y=train_target, epochs=1_000, verbose=0)
```
<img width="400" height="29" alt="image" src="https://github.com/user-attachments/assets/56c83322-58f4-4e85-b9be-ef585eee2597" />

```python
predicts = model.predict(x=tr_data_scaled_flat)
#> 48,000개 이미지의 각 레이블이 될 확률을 리턴.
```
<img width="464" height="29" alt="image" src="https://github.com/user-attachments/assets/73ed4801-1f94-4f2a-816d-7d462eeb4e33" />

```python
predicts.shape  #> (48_000 이미지 샘플, 10개 확률)
```
```python
print(predicts[:2])
```
<img width="449" height="117" alt="image" src="https://github.com/user-attachments/assets/bb2fa84f-254a-4bb4-bec0-7be8ad8db22e" />

```python
tr_pred_labels = predicts.argmax(axis=1)
# argmax(): 최댓값의 인덱스를 리턴. 10개의 확률들 중 최댓값의 인덱스가 예측 레이블이 됨.
```
```python
tr_pred_labels.shape
```
<img width="66" height="32" alt="image" src="https://github.com/user-attachments/assets/6a174425-26bc-45bf-a763-728cea6aefcc" />

```python
tr_pred_labels[:2]
```
<img width="98" height="29" alt="image" src="https://github.com/user-attachments/assets/3775bc9e-c733-4bce-a87c-980bc177cc68" />

```python
accuracy_score(y_true=train_target, y_pred=tr_pred_labels)
```
<img width="144" height="29" alt="image" src="https://github.com/user-attachments/assets/cb1914b1-5177-4c12-832f-945310bf3ea2" />

```python
# 훈련 셋 평가 - model의 evaluate 메서드를 사용할 수도 있음.
model.evaluate(x=tr_data_scaled_flat, y=train_target, verbose=0)
#> [loss(손실), accuracy(정확도)]
```
<img width="285" height="31" alt="image" src="https://github.com/user-attachments/assets/80fa47eb-b948-40e2-82fa-f82542d86406" />

```python
# 검증 셋 평가
model.evaluate(x=val_data_scaled_flat, y=val_target, verbose=0)
```
<img width="289" height="28" alt="image" src="https://github.com/user-attachments/assets/6c86e330-3775-4616-a764-4ac79db25376" />
