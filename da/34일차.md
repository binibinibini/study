# company 이름의 오타 수정

```python
mpg.loc[mpg.company == 'chevroelt', 'company'] = 'chevrolet'    # 'chevroelt'이름을 가진 행에서 company 컬럼을 chevrolet로 변경
mpg.loc[mpg.company == 'maxda', 'company'] = 'mazda'
mpg.loc[mpg.company == 'mercedes', 'company'] = 'mercedes-benz'
mpg.loc[mpg.company == 'toyouta', 'company'] = 'toyota'
mpg.loc[mpg.company == 'vokswagen', 'company'] = 'volkswagen'
```
```python
companies = mpg.company.unique()
companies.sort()
companies
```
![image](https://github.com/user-attachments/assets/d53295bb-80d4-453b-8809-13b9bdbbe45e)

```python
companies.size
```
![image](https://github.com/user-attachments/assets/e9b0558a-3075-4c40-80da-20936b9b3b81)

# movies 데이터셋

```python
movies_file = 'https://github.com/wesm/pydata-book/raw/refs/heads/3rd-edition/datasets/movielens/movies.dat'
```

```python
# movies.dat 파일은 값들이 '::'로 구분된 텍스트 파일.
movies = pd.read_csv(movies_file,
                     sep = '::',                                 # 구분자
                     names = ['movie_id', 'title', 'genres'],    # 컬럼 이름
                     engine = 'python')                          # sep = '::' 때문에 발생하는 경고(warning)를 없애기 위해서
```

```python
movies.head()
```
![image](https://github.com/user-attachments/assets/265a678c-1c53-470c-a644-fdf043821169)

```python
movies.tail()
```
![image](https://github.com/user-attachments/assets/77fa3047-836a-414b-8708-2a4b5bda2666)

```python
movies.info()
```
![image](https://github.com/user-attachments/assets/589751dc-fc7e-42d1-a966-44f5852c6002)

* 장르 분석
    * 장르가 Animation인 영화는 몇 개?
    * 가장 많이 등장하는 장르 이름?
* 개봉 연도 분석
    * 연도별 개봉 영화 숫자

## 장르가 Animation인 영화
```python
animations = movies[movies.genres.str.contains('Animation')]
```
```python
animations.head()
```
![image](https://github.com/user-attachments/assets/44ff1f4d-ed81-46e9-a9d4-5aa33cef390e)

```python
animations.tail()
```
![image](https://github.com/user-attachments/assets/31f6ec1d-3da9-4b0e-8767-d909360e9603)

```python
animations.info()
```
![image](https://github.com/user-attachments/assets/b747c548-188f-4792-95be-b1d41b707d9f)

```python
animations.size  # 행(row)의 개수 x 열(column)의 개수
```
![image](https://github.com/user-attachments/assets/1b2780e1-c7f5-492d-b2f8-8e631b2382be)

```python
len(animations)
```
![image](https://github.com/user-attachments/assets/5b17763d-efc2-4361-96cb-fa360b87a5f6)

## 장르가 Drama인 영화

```python
dramas = movies[movies.genres.str.contains('Drama')]
dramas.head()
```
![image](https://github.com/user-attachments/assets/a33cfa39-9c79-4883-b42d-40a63ccfd0be)

```python
len(dramas)
```
![image](https://github.com/user-attachments/assets/849799f2-d56d-47a2-975a-1fd810dba3a5)

# 장르가 로맨틱 코미디(Romance & Comedy)인 영화

```python
romanticd_comedies = movies[movies.genres.str.contains('Romance') &
                      movies.genres.str.contains('Comedy')]
romantic_comedies.head()
```
![image](https://github.com/user-attachments/assets/6621ed62-7ce8-454a-ade1-c2895edd9f89)

```python
len(romanticd_comedies)
```
![image](https://github.com/user-attachments/assets/bdacb942-8eea-4329-bc4b-def1fa32ef85)

## 가장 많이 등장하는 영화 장르 상위 10개

```python
genres = []    # 장르들을 저장하기 위한 빈 리스트

for x in movies.genres:
    genres.extend(x.split(sep = '|'))  # extend는 1차원 배열로 저장
```

- append()는 리스트 통째로 넣고, extend()는 요소 하나씩 풀어서 넣음

```python
print(genres)
```
![image](https://github.com/user-attachments/assets/3cc6f1de-a2bf-4cc8-b626-30efb7542247)

```python
pd.value_counts(genres)
```
![image](https://github.com/user-attachments/assets/e4088933-2603-4d3e-8f17-ef9035d45a47)

```python
genres_series = pd.Series(genres)    # list -> pd.Series 타입으로 변환
print(genres_series)
```
![image](https://github.com/user-attachments/assets/2c949d87-af0c-498e-88a3-9ca332c14ab8)

```python
genre_count = genres_series.value_counts()    # 내림차순으로 결과를 보여줌
genre_count
```
![image](https://github.com/user-attachments/assets/fbe35d00-7b61-41d3-a822-4658d0a1ab7b)

```python
top10_genre = genre_count.head(n = 10)
top10_genre
```
![image](https://github.com/user-attachments/assets/94320015-c182-4b6f-9bd0-e1a70575efb7)

```python
# sns.barplot(data = top10_genre)   # 세로 막대 그래프
sns.barplot(x = top10_genre, y = top10_genre.index)
plt.show()
```
![image](https://github.com/user-attachments/assets/b38cb832-5552-40c2-aaef-d4707b6494b0)

## 영화 장르 하위 10개
<br>

링크 텍스트 등장하는 영화 장르 하위 10개

```python
low10_genre = genre_count.tail(n = 10)
low10_genre
```
![image](https://github.com/user-attachments/assets/ebe31467-778d-48be-b313-7ad36f4944f6)

```python
sns.barplot(x = low10_genre, y = low10_genre.index)
plt.show()
```
![image](https://github.com/user-attachments/assets/f5873736-cd7b-441f-98a4-ea223cef9057)

## 영화 개봉 연도 분석

- 영화 제목(title)에서 영화 개봉 연도를 찾아서 파생 변수(year) 생성 <br>
- 연도별 개봉 영화 수 <br>
- 그래프 시각화 <br>

```python
movies.head()
```
![image](https://github.com/user-attachments/assets/2ca0f845-58cf-4b6f-810d-29d9067569dd)

```python
movies['year'] = movies.title.str[-5:-1].astype('int')
```

```python
movies.head()
```
![image](https://github.com/user-attachments/assets/52456d95-ef88-4cec-94e1-f5fb354ada5c)

```python
movies.info()
```
![image](https://github.com/user-attachments/assets/7123beef-9cae-4f1f-a281-99539dfda930)

```python
year_count = movies.year.value_counts()
year_Count
```
![image](https://github.com/user-attachments/assets/5098a43e-f157-431f-b9bc-31a897a69633)

```python
sns.barplot(data = year_count)
plt.show()
```
![image](https://github.com/user-attachments/assets/7edce3ba-a956-4fa7-a9c2-ebc941e44d22)

```python
sns.lineplot(data = year_count)
plt.show()
```
![image](https://github.com/user-attachments/assets/22198581-d67e-419b-9c32-6a24def6741e)


# DataFrame 합치기

- merge: 두 개 이상의 데이터프레임을 공통된 컬럼(들)을 기준으로 합치는 것. SQL의 join과 비슷.
- concat: 두 개 이상의 데이터프레임을 축(axis)을 따라서 합치는 것.

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```

# merge

```python
emp = pd.DataFrame(data = {
    'empno': [100, 101, 200, 201],
    'ename': ['Scott', 'Tiger', 'King', '오쌤'],
    'deptno': [10, 20, 10, 50]
})
emp
```
![image](https://github.com/user-attachments/assets/6a1f443a-7d75-4bf4-bec9-d93394aaaa2b)

```python
dept = pd.DataFrame(data = {
    'deptno': [10, 20, 30],
    'dname': ['HR', 'IT', 'Sales']
})
dept
```
![image](https://github.com/user-attachments/assets/2d1b7a87-a914-4ea7-872f-b3b6285b2145)

<br>

- pd.merge(left, right, how, on, ...) 함수<br>
- pd.DataFrame.merge(right, how, on, ...) 메서드<br>
- 파라미터 how: merge 방식(inner, left, right, outer). 기본값은 'inner'.<br>
- 파라미터 on: join의 기준이 되는 컬럼(들의 리스트). join 컬럼 이름이 같은 경우에는 생략 가능.<br>
