# NumPy 고급기능

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```

# np.ndarray 속성

```python
arr = np.ones(shape = (2, 3))
print(arr)    # 2차원 배열. 데이터타입은 실수(1.) -> 뒤에 0은 생략
```
![image](https://github.com/user-attachments/assets/2e1f72cb-e079-48a9-b0d8-578656d14320)

```python
arr.shape    # shape 속성: 배열의 각 축(axis)을 따라서 읽는 원소의 개수들의 tuple. (row 개수, column 개수)
```
![image](https://github.com/user-attachments/assets/138884d2-3108-48c4-9a5e-da5b59c306d4)

![image](https://github.com/user-attachments/assets/82525e8c-60b5-47f3-812c-32e078d3c803)

```python
arr.dtype    # dtype 속성: 배열 원소의 데이터 타입.
```
![image](https://github.com/user-attachments/assets/37433e1a-bb2a-4688-806a-09e2448a0e9b)

```python
arr.size    # size 속성: 배열의 모든 원소 개수.
```
![image](https://github.com/user-attachments/assets/b926876b-7a0a-4597-bf2b-7f3f0d2a50cf)

```python
arr.ndim    # ndim: 배열의 차원(dimension). 배열의 축(axis)의 개수.
```
![image](https://github.com/user-attachments/assets/8f96e7db-bd35-4c83-b0a7-089a91c0983a)

```python
arr = np.arange(10)    # 0 이상 10 미만의 (10개의) 정수들로 이루어진 배열.
```
```python
print(arr)
```
![image](https://github.com/user-attachments/assets/88130595-42b1-474c-a75d-df9365bec2bb)

```python
print('dtype:', arr.dtype)
print('ndim:', arr.ndim)
print('shape:', arr.shape)
print('size:', arr.size)
```
![image](https://github.com/user-attachments/assets/d2e945f5-1596-4543-a57f-1811f7bf8281)

# Indexing

```python
print(arr)    # 3d array(3차원 배열)
```
![image](https://github.com/user-attachments/assets/851e894a-b67e-4c04-8af5-8f7188503566)

![image](https://github.com/user-attachments/assets/f25f40e8-54aa-4779-9ae6-b98767cc9083)


```python
print(arr[0])    # 2d array
```
![image](https://github.com/user-attachments/assets/59023ce8-68ee-460e-872f-9d0231aa0d38)

```python
print(arr[0, 0])    # 1d array
```
![image](https://github.com/user-attachments/assets/a724dde2-7e7f-4542-9684-761da96681ec)

```python
print(arr[0][0])
```
![image](https://github.com/user-attachments/assets/6d31406d-f2aa-4518-989b-1d537c94b3a1)

```python
print(arr[0, 0, 0])    # int -> 스칼라(scalar : 원소 한개)
```
![image](https://github.com/user-attachments/assets/563e302c-d922-4c8d-a208-d6b81f1e89bf)

```python
print(arr[0][0][0])
```
![image](https://github.com/user-attachments/assets/f2da78c9-b31e-431a-9aeb-9fba20b7f41c)

*   Python list 인덱스 사용 방법:
    *   `list[i][j][k]...`
*   NumPy ndarray 인덱스 사용 방법:
    *   `array[i, j, k, ...]`
    *   `array[i][j][k]...`

# Slicing

## 1차원 배열의 Slicing

```python
np.random.seed(1)
arr = np.random.randint(100, size = 10)    # [0, 100) 범위의 정수 난수 10개로 이루어진 1d array.
print(arr)
```
![image](https://github.com/user-attachments/assets/db330691-c719-4727-9603-aa1eef95d7f1)

```python
print(arr[1:5])    # (5 - 1 = 4 -> slicing된 원소의 개수)
```
![image](https://github.com/user-attachments/assets/9a61114a-3e43-4caa-ae1e-8de42ffc628a)

```python
print(arr[:3])    # 시작 인덱스 0은 생략 가능
```
![image](https://github.com/user-attachments/assets/c6a23019-9493-4ef8-8b38-a92e4d54ec58)

```python
print(arr[-3:]    # 배열의 끝까지 자를 때는 마지막 인덱스는 생략 가능.
# 배열의 끝에서부터 거꾸로 매기는 인덱스는 음수 인덱스.
```
![image](https://github.com/user-attachments/assets/805b3353-7b43-4b81-a6ef-3b45b52a37dc)

```python
print(arr[0:1])    # slicing의 결과 -> 배열
print(arr[0])    # indexing의 결과 -> 원소 (스칼라)
```
![image](https://github.com/user-attachments/assets/4a4d4cb1-34a8-436c-886a-6b287ad76bc1)

## 2차원 배열의 slicing

```python
arr = np.arange(1, 21).reshape((4, 5))
print(arr)
```
![image](https://github.com/user-attachments/assets/f933a62d-f772-45f2-96b3-45c404278486)

```python
# 2차원 배열 arr의 첫 2개의 1차원 배열
# print(arr[:2])
print(arr[:2, :])
```
![image](https://github.com/user-attachments/assets/7fafd7da-cdb2-45cc-9826-548f56310e92)

```python
# 2차원 배열 arr의 마지막 2개의 1차원 배열
# print(arr[-2:])
print(arr[-2: , :])
```
![image](https://github.com/user-attachments/assets/f6f4436f-9e5a-4108-a9e8-7c361f07e934)

```python
print(arr[:2, :3])
```
![image](https://github.com/user-attachments/assets/203aff85-fdb2-49e0-953c-3fd01d5a9953)

```python
print(arr[1:3, 1:4])
```
![image](https://github.com/user-attachments/assets/7066cc1e-06ee-4e29-b74f-36820d0b7370)

```python
print(arr[1:3][1:4])    # 위쪽 셀의 결과와 비교!
```
![image](https://github.com/user-attachments/assets/8a4ab208-80d8-403e-b133-d36242338035)

## 3차원 배열의 slicing

```python
arr = np.arange(1, 61).reshape((3, 4, 5))
print(arr)
```
![image](https://github.com/user-attachments/assets/d5565715-bb39-4ec3-af82-cf69b45d8b95)

```python
# print(arr[:2, :, :])
print(arr[:2])
```
![image](https://github.com/user-attachments/assets/ea56e510-9696-4122-b26f-ef60e4cfeb36)

```python
# print(arr[:2, :2, :])
print(arr[:2, :2])
```
![image](https://github.com/user-attachments/assets/00bc6aba-288e-4cc8-94ec-adc59657928e)

```python
print(arr[:2, :2, :2])
```
![image](https://github.com/user-attachments/assets/f2ea9d15-0902-4f50-b356-5d6ff6e30e74)

```python
print(arr[:1, :, :])    # 결과: 3d array. (slicing)
```
![image](https://github.com/user-attachments/assets/3338a3f2-538e-4aff-81a2-06e04c0ae8b2)

```python
print(arr[0, :, :])    # 결과: 2d array. (indexing)
```
![image](https://github.com/user-attachments/assets/d4a8ccdd-ea44-4233-948c-e793d0362f1e)

# Shape(모양) 변경
*   `np.ndarray.reshape(arg)`
*   `np.ndarray.ravel()`
*   `np.ndarray.flatten()`
*   `np.newaxis` 속성

## reshape
```python
arr_1d = np.arange(12)
print(arr_1d)
```
![image](https://github.com/user-attachments/assets/f034e1fe-2f14-4359-bc8d-157e8c516f92)

```python
# arr_1d를 (4, 3) shape의 2d array로 변환
arr_2d = arr_1d.reshape((4, 3))
print(arr_2d)
```
![image](https://github.com/user-attachments/assets/cfd2c835-180e-4b99-b8b1-261724b02734)

```python
# reshape 메서드의 아규먼트를 전달할 때 자동으로 계산할 수 있는 차원의 값은 -1을 사용할 수 있음.
arr_2d = arr_1d.reshape((4, -1))    # (4, 3)
print(arr_2d)
```
![image](https://github.com/user-attachments/assets/4d1075f9-3bea-4a40-afdb-82d8c214e1df)

```python
arr_2d = arr_1d.reshape((-1, 4))    # (3, 4). 열을 갯수를 정하면 행을 갯수를 알아서 해
```
![image](https://github.com/user-attachments/assets/d74d207a-a909-450b-acab-260a3d6b3d81)

```python
# 2차원 배열 arr_2d을 1차원 배열로 변환.
result = arr_2d.reshape((12,))    # arr_2d.reshape((3 * 4,))
print(result)
```
![image](https://github.com/user-attachments/assets/38412e8b-9c7d-44b0-af84-192e1628de07)

```python
result = arr_2d.reshape((-1, ))
print(result)
```
![image](https://github.com/user-attachments/assets/792cd183-dd87-4060-b441-ff495c885c6a)

```python
arr_1d = np.arange(60)
print(arr_1d)
```
![image](https://github.com/user-attachments/assets/f2b7258c-29d4-4678-b94a-3ff181c43693)

```python
# 1차원 배열 arr_1d의 모양을 (3, 4, 5)로 변환
result = arr_1d.reshape((3, 4, 5))    # arr_1d.reshape((3, 4, -1))
print(result)
```
![image](https://github.com/user-attachments/assets/721973af-bce8-4cee-84a2-c14ae3f290a4)

```python
# 1차원 배열 arr_1d의 모양을 (5, 4, 3)로 변환
result = arr_1d.reshape((5, 4, -1))    # arr_1d.reshape((5, 4, 3))
print(result)
```
![image](https://github.com/user-attachments/assets/0af5acaa-09e8-49f9-861a-abadafd0fbb3)

## ravel vs flatten

*   flatten
    *   n차원 배열 ndarray를 1차원 배열로 변환한 "복사본"을 리턴.
    *   원본 배열과는 별개의 새로운 배열을 메모리에 만들어서 리턴.
*   ravel
    *   n차원 배열 ndarray를 1차원 배열로 변환한 "뷰(view)"를 리턴.
    *   별개의 새로운 배열을 만드는 것이 아니라, 원본 배열의 모양을 1차원으로 보여줄 뿐.
 
```python
arr_2d = np.arange(12).reshape((3, 4))
print(arr_2d)
```
![image](https://github.com/user-attachments/assets/5991e83c-0cbe-478f-833c-ad1b604ed317)

```python
flattened = arr_2d.flatten()
print(flattened)
```
![image](https://github.com/user-attachments/assets/9cff83e5-1cee-4bd5-8ae2-98ad61f81862)

```python
flattened[0] = 123    # 1차원 배열 flattened의 첫번째 위치에 새로운 값을 재할당.
print(flattened)
```
![image](https://github.com/user-attachments/assets/2b234254-9743-4fc3-801e-d545e95c5a20)

```python
print(arr_2d)    # 원본 2차원 배열과는 무관.
```
![image](https://github.com/user-attachments/assets/efc74af9-473a-4cbb-b535-57bdc5714ffa)

```python
raveled = arr_2d.ravel()
print(raveled)
```
![image](https://github.com/user-attachments/assets/a577476d-0dc9-4811-8325-bdf8632abdfa)

```python
raveled[0] = 123      # 1차원 배열의 원소를 변경
print(raveled)
```
![image](https://github.com/user-attachments/assets/c47dfa8e-f5e5-4bb7-b5d9-da529f286278)

```python
print(arr_2d)      # 원본 2차원 배열의 값을 변경!
```
![image](https://github.com/user-attachments/assets/17aa4c5e-9077-4781-a328-9577a86713ad)

## `np.newaxis` 속성을 사용한 차원 늘리기
```python
arr = np.arange(1, 6)
print(arr)
```
![image](https://github.com/user-attachments/assets/fbed9cdc-90bf-45c5-b207-0dab6845fbfb)

```python
arr.shape      # (5,)
```
![image](https://github.com/user-attachments/assets/869f38b5-5b28-41e0-a062-29795df31422)

```python
result = arr[np.newaxis, :]      # 행 방향으로 추가할 때
print(result)
```
![image](https://github.com/user-attachments/assets/989d7119-67fc-4def-bf8f-023308c40ac3)

```python
result.shape      # 행 방향으로 1개, 컬럼 방향으로 5개 -> (1, 5)
```
![image](https://github.com/user-attachments/assets/d4f177e9-23ec-4bbe-a19b-b7935da8de14)

```python
print(arr)      # 원본은 그대로
```
![image](https://github.com/user-attachments/assets/a2e83b00-4fda-442f-8196-2669f9410950)

```python
result = arr[:, np.newaxis]      # 열 방향으로 추가할 때
print(result)
```
![image](https://github.com/user-attachments/assets/c5f1f97e-8441-4cc2-a7d2-da712b3bc6d7)

```python
result.shape      # (5, 1)
```
![image](https://github.com/user-attachments/assets/5962aa56-a45d-43be-b2bc-838ae1e732e1)

```python
print(arr_2d)      # shape: (3, 4)
```
![image](https://github.com/user-attachments/assets/dc5767ec-2e7c-4931-8ac1-196c79e4b74b)

```python
result = arr_2d[np.newaxis, :, :]
```
![image](https://github.com/user-attachments/assets/c89b25aa-b2d2-487a-8b90-0c9da5f0fcf0)

```python
result.shape      # (1, 3, 4). 첫번째 축 방향으로 1개.
```
![image](https://github.com/user-attachments/assets/6a0a71c8-10fd-480d-a6be-411f9ae15dba)

```python
result = arr_2d[:, :, np.newaxis]
print(result)
```
![image](https://github.com/user-attachments/assets/0335ca03-fad9-4873-ab20-760271f6dc1b)

```python
result.shape      # (3, 4, 1)
```
![image](https://github.com/user-attachments/assets/d95fb826-451d-4fb5-9b1f-5eaad119f316)

```python
result = arr_2d[:, np.newaxis, :]
print(result)
```
![image](https://github.com/user-attachments/assets/b12cbc7c-7a4a-4e67-a708-fe65937e406a)

```python
result.shape      # np.newaxis 넣은 부분 말고, 나머지는 원소의 개수 유지.
```
![image](https://github.com/user-attachments/assets/2fb87027-87b1-466a-a273-a17a72d8f5e6)

```python
print(arr)
```
![image](https://github.com/user-attachments/assets/6664fb36-b087-4e0d-b194-df186cf34ed2)

```python
result = arr[:, np.newaxis, np.newaxis]
print(result)
```
![image](https://github.com/user-attachments/assets/8d4fbc68-27d5-47e8-8d02-35681772a3e1)

```python
result.shape
```
![image](https://github.com/user-attachments/assets/479c7e2b-b675-4579-a663-34d1822ca977)

# concatenate
*   `np.concatenate([array1, array2, ...], axis = 0)`: 특정 축(axis) 방향으로 배열을 이어붙이기.
*   `np.r_[array1, array2]`: 행들을 이어붙이기. axis = 0 방향으로 이어붙이기.
*   `np.c_[array1, array2]`: 컬럼들을 이어붙이기. axis = 1 방향으로 이어붙이기.

```python
# (2, 3) shape의 2d array
arr1 = np.arange(1, 7).reshape((2, 3))
print(arr1)
```
![image](https://github.com/user-attachments/assets/a33a439a-e701-4e9b-b5d7-ac10e85ab5e7)

```python
# (1, 3) shape의 2d array
arr2 = np.array([[7, 8, 9]])
print(arr2)
```
![image](https://github.com/user-attachments/assets/69c5a718-81ea-408e-875d-f3f4d5d5648b)

```python
# (2, 1) shape의 2d array
arr3 = np.array([[10], [11]])
print(arr3)
```
![image](https://github.com/user-attachments/assets/e22ae092-3c3b-46d9-8f59-a25e9df620f7)

```python
result = np.concatenate([arr1, arr2])      # axis = 0 생략 가능(기본값)
print(result)
```
![image](https://github.com/user-attachments/assets/6396fa89-9ee7-4ff4-9744-84c0da1b4faa)

```python
np.r_[arr1, arr2]      # arr1과 arr2가 2d array일 때 concatenate를 간단히.
```
![image](https://github.com/user-attachments/assets/3b2c07e5-28e2-4030-ba10-cb2e7c7dbb8f)

```python
result = np.concatenate([arr1, arr3], axis = 1)
print(result)
```
![image](https://github.com/user-attachments/assets/f926e8f0-c0e9-42e9-80ee-86bbb7e9a0f5)

```python
np.c_[arr1, arr3]      # arr1과 arr3이 2d array일 때 concatenate를 간단히.
```
![image](https://github.com/user-attachments/assets/e164bb76-6063-4e5e-915c-6ce07eff2bd6)

# Broadcasting
*   np.ndarray의 연산(+, -. *, /, //, %, >, <, ==, ...)은 같은 위치(인덱스)의 원소들끼리(elementwise) 연산이 수행됨.
*   서로 모양(shape)이 다른 배열들끼리 연산이 가능한 경우가 있음. broadcast가 가능한 경우.(원소들을 복사했을 때 같은 모양으로 만들 수 있으면 연산 가능)

```python
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])
```
```python
print(a + b)
```
![image](https://github.com/user-attachments/assets/2e6bced4-e1d1-455d-b4d2-2532e10641e0)

```python
c = np.array([7, 8])
# print(a + c)  # ValueError: (3,) shape의 1d array와 (2,) shape의 1d array는 서로 연산을 할 수 없음.
```

## ndarray와 scalar의 연산
<br>
항상 broadcast가 가능.항상 연산이 가능. 스칼라를 배열의 각 원소마다 연산 수행.

```python
print(a + 10)
```
![image](https://github.com/user-attachments/assets/e8fcedc3-39ca-4da1-94f4-e4ac7228202b)

## 2d array와 1d array 또는 2d array에서의 broadcast

```python
a = np.arange(1, 7).reshape((2, 3))      # shape: (2, 3)
print(a)
```
![image](https://github.com/user-attachments/assets/11597223-cd5a-40e6-b1c8-b789b0f1a4be)

```python
b = np.array([7, 8, 9])      # shape: (3,)
print(b)
```
![image](https://github.com/user-attachments/assets/6a5c8aa1-c689-4463-a14d-0fe26409f190)

```python
#   (3,) shape의 1d array -> (1, 3) shape 2d array -> (2, 3) shape으로 broadcast
print(a + b)
```
![image](https://github.com/user-attachments/assets/7d4ac7e8-7026-4897-8bc4-5b48a3d9bc89)

```python
b = np.array([[5], [10]])      # shape: (2, 1)
print(b)
```
![image](https://github.com/user-attachments/assets/fede1d5a-ac7d-4a45-aa0c-2ddfcd00e5a6)

```python
#   (2, 1) shape의 2d array -> (2, 3) shape으로 broadcast
print(a + b)
```
![image](https://github.com/user-attachments/assets/00e78984-e749-4e99-b548-3d9404ff3590)

<br>
broadcasting이 가능한 경우:

*   브로드캐스팅은 누락되거나 길이가 1인 차원에 대해서만 수행.
*   이어지는 차원의 축이 길이가 같은 경우 브로드캐스팅이 가능.
<br>

## broadcast 활용

*   표준화(standardization): 배열의 평균이 0이 되고, 표준편차가 1이 되도록 값들을 변환.
*   정규화(normalization): 최솟값이 0이 되고 최댓값이 1이 되도록 값들을 변환.

### 표준화

```python
x = np.array([1, 2, 3, 4, 5])
```
```python
mu = x.mean()      # 평균, np.mean(x)
print(mu)
```
![image](https://github.com/user-attachments/assets/c27b3e1b-49f3-4438-b50b-a32ad43dc31a)

```python
sigma = x.std()      # 표준편차, np.std(x)
print(sigma)
```
![image](https://github.com/user-attachments/assets/5d9fabd7-6406-462f-af25-29748e1fc8b9)

```python
x_scaled = (x - mu) / sigma      # 표준화 공식
print(x_scaled)
```
![image](https://github.com/user-attachments/assets/e4b815f1-8630-4718-8e5d-f14286dbb9d5)

```python
np.mean(x_scaled)
```
![image](https://github.com/user-attachments/assets/1c4b375d-50b9-4a04-99fc-3b5f98bd7358)

```python
np.std(x_scaled)
```
![image](https://github.com/user-attachments/assets/1b43f78d-075f-406e-8f72-2ea53b895254)

### 정규화
```python
x_min = np.min(x)      # 배열 x의 최솟값
x_max = np.max(x)      # 배열 x의 최댓값
print(x_min, x_max)
```
![image](https://github.com/user-attachments/assets/0e392f11-f64b-45e1-b497-9062c0b414ee)

```python
x_scaled = (x - x_min) / (x_max - x_min)
print(x_scaled)
```
![image](https://github.com/user-attachments/assets/a4b16155-6e83-4bb1-a92e-ba8995e15c9c)

### 2차원 배열에서 표준화, 정규화

```python
# (3, 2) shape 2d array
x = np.arange(1, 7).reshape((3, 2))
print(x)
```
![image](https://github.com/user-attachments/assets/4e11b0d8-55cd-4162-854d-9b8e46f1725b)

```python
# 표준화
X_scaled = (X - np.mean(X)) / np.std(X)
print(X_scaled)
```
![image](https://github.com/user-attachments/assets/4f4863e5-7251-43f6-852d-7d3292824707)

```python
# 정규화
X_scaled = (X - np.min(X)) / (np.max(X) - np.min(X))
print(X_scaled)
```
![image](https://github.com/user-attachments/assets/384e4698-e143-4286-8042-d04159cbd844)

```python
np.mean(X, axis = 0, keepdims = True)      # keepdims = True -> 차원 유지
```
![image](https://github.com/user-attachments/assets/35f85354-50ec-4b83-b6d5-7972d8aace92)

```python
np.mean(X, axis = 1, keepdims = True)
```
![image](https://github.com/user-attachments/assets/d2117756-e7ca-4d1b-aa08-9c60b594b49f)

<br>
axis = 0 축 방향으로 표준화
<br>

```python
X_scaled = (X - np.mean(X, axis = 0, keepdims = True)) / np.std(X, axis = 0, keepdims = True)
print(X_scaled)
```

![image](https://github.com/user-attachments/assets/cd608072-7e50-4897-a674-b433fe0224f9)

<br>
axis=1 축 방향으로 표준화
<br>

```python
X_scaled = (X - np.mean(X, axis = 1, keepdims = True)) / np.std(X, axis = 1, keepdims = True)
print(X_scaled)
```

![image](https://github.com/user-attachments/assets/a2211476-f61d-4bc6-b37d-39936e48d0f5)

<br>
axis = 0 축 방향으로 정규화
<br>

```python
X_min = np.min(X, axis = 0, keepdims = True)
X_max = np.max(X, axis = 0, keepdims = True)
X_scaled = (X - X_min) / (X_max - X_min)
print(X_scaled)
```

![image](https://github.com/user-attachments/assets/0587ff84-9c6d-4efb-adba-b84f9dfd469d)

