```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```
# merge, concat 연습 2. 신생아 이름 데이터셋
<br>
- https://github.com/wesm/pydata-book/tree/3rd-edition/datasets/babynames<br>
- 데이터 파일들을 사용<br>
- 1880년부터 2010년까지 미국 신생아들의 이름, 성별, 출생자수가 정리된 파일<br>
- 파일을 하나씩 읽어서 데이터 프레임 생성하세요.<br>
- 생성된 데이터 프레임에 year 컬럼을 추가하세요. (1880년 파일은 year에 1880을 넣어라(파생 변수))<br>
- 생성된 131개의 데이터 프레임을 하나로 합치세요.<br>
- 연도별 신생아 수를 찾고 그래프를 그리세요.<br>
- 연도별 성별 신생아 수를 찾고 그래프를 그리세요.<br>

```python
y_df = {}
baby_df = []

for i in range(1880, 2011):
    file = f'https://github.com/wesm/pydata-book/raw/refs/heads/3rd-edition/datasets/babynames/yob{i}.txt'
    df = pd.read_csv(file, names = ['name', 'sex', 'no'])
    y_df[i] = df
    y_df[i]['year'] = i
    baby_df.append(y_df[i])
```
```python
df = pd.concat(baby_df)
df
```
![image](https://github.com/user-attachments/assets/7e8fa28b-5196-4a50-8c17-6095e847ae4b)

```python
df.info()
```
![image](https://github.com/user-attachments/assets/f64332be-b563-4313-8ea2-6559895a30a8)

```python
df.head()
```
![image](https://github.com/user-attachments/assets/8d9ef41d-f9b7-4504-9380-262a1367cf67)

```python
df.year.value_counts()
```
![image](https://github.com/user-attachments/assets/3b2e43fc-7f89-4f3f-b2b1-4a59740a30af)

```python
# 풀이
col_names = ['name', 'gender', 'births']    # 데이터프레임 컬럼 이름

yobs = []    # 각 연도의 데이터프레임을 저장할 빈 리스트
for year in range(1880, 2011):
    # txt 파일이 저장된 github 경로
    file_path = f'https://github.com/wesm/pydata-book/raw/refs/heads/3rd-edition/datasets/babynames/yob{year}.txt'
    # 파일을 읽어서 데이터프레임을 생성
    yob_year = pd.read_csv(file_path, names = col_names)
    # 데이터프레임에 year 파생변수를 추가
    yob_year['year'] = year
    # 생성된 데이터프레임을 리스트에 추가
    yobs.append(yob_year)
```
```python
len(yobs)    # 리스트의 원소 개수 - 데이터프레임 개수
```
![image](https://github.com/user-attachments/assets/87841aa5-9d18-414a-baa5-dffd88b53be6)

```python
yobs[0]    # 리스트의 첫번째 원소 -> 1880년 데이터프레임
```
![image](https://github.com/user-attachments/assets/ba7ae063-6703-4045-a76a-a0189010edb7)

```python
yobs[-1]    # 리스트의 마지막 원소 -> 2010년 데이터프레임
```
![image](https://github.com/user-attachments/assets/8b4e1e47-10d5-4520-a27d-eb83ec07e395)

```python
# 풀이
yob_df = pd.concat(yobs, ignore_index = True)    # index 무시
```
```python
yob_df.head()
```
![image](https://github.com/user-attachments/assets/25339519-91f9-4254-b5a3-0dad8cab20bc)

```python
yob_df.tail()
```
![image](https://github.com/user-attachments/assets/78632962-6243-4057-9b86-508e0bc48c1f)

```python
yob_df.info()
```
![image](https://github.com/user-attachments/assets/db5d186b-e5db-48e6-9ee5-9fac95f8dbf2)

## 연도별 신생아 수
```python
yob_by_year = yob_df.groupby(by = ['year']).births.sum()
```
```python
yob_by_year.head()
```
![image](https://github.com/user-attachments/assets/9d41bbd4-3297-4bc4-b3f8-7d8f4e4b7598)

```python
yob_by_year.tail()
```
![image](https://github.com/user-attachments/assets/a2e93213-3a30-4ae5-885f-e3320b93c816)

```python
sns.lineplot(data = yob_by_year)
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/ca730403-2361-40bb-b367-7b031a6bd2d4)

## 연도별 성별 신생아 수

```python
yob_by_year_gender = yob_df.groupby(by = ['year', 'gender']).births.sum()
yob_by_year_gender
```
![image](https://github.com/user-attachments/assets/11e8ca41-1c14-401f-b78b-2254fbef6114)

```python
df_by_year_gender = yob_by_year_gender.reset_index()
df_by_year_gender
```
![image](https://github.com/user-attachments/assets/af9f515a-efb3-4633-a914-bae15e8e3328)

```python
sns.lineplot(data = df_by_year_gender, x = 'year', y = 'births', hue = 'gender')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/bfb6d789-bc9e-4e5e-b386-baf060f2eb77)

```python
# seaborn 모듈의 그래프 함수들은 그룹별 통계(평균, 합계, ...) 기능을 가지고 있음. 위에 그래프보다 시간이 더 걸림
sns.lineplot(data = yob_df, x = 'year', y = 'births', hue = 'gender', estimator = 'sum', errorbar = None)
plt.show()
```
![image](https://github.com/user-attachments/assets/dcc7c0c7-ed87-4014-8106-d9dd127b9469)

------
# Series 인덱스

## 단일 계층 인덱스

```python
s = pd.Series(data = np.random.rand(5))
s    # Series 객체를 생성할 때 index를 설정하지 않으면 RangeIndex가 자동으로 만들어짐.
```
![image](https://github.com/user-attachments/assets/be66d2a8-56ea-4f96-a183-d0f5cd5c3056)

```python
s.index    # 인덱스 - row label(행 레이블)
```
![image](https://github.com/user-attachments/assets/4a974de7-da45-4cd1-93ee-01b7d6a6351e)

```python
s.value    # 값 -> np.ndarray
```
![image](https://github.com/user-attachments/assets/53de4025-c295-41f5-80e8-3d50b65a138e)

```python
s = pd.Series(data = np.random.rand(5),
              index = ['a', 'b', 'c', 'd', 'e'])
s    # 생성자에서 설정한 index 객체가 만들어짐.
```
![image](https://github.com/user-attachments/assets/1bb2f625-ae85-4449-8fb4-c4d4eeff2f7e)

```python
s.index
```
![image](https://github.com/user-attachments/assets/1e62f8d7-a249-4df1-bc39-0e40bb5081e2)

```python
s.index.nlevels    # Index.nlevels 속성(property): 인덱스 계층(level)의 개수.
```
![image](https://github.com/user-attachments/assets/dd8683af-80a0-47ab-9b5d-f7e49d802e58)

## 계층적 인덱스(hierachical index), Multi-level index

```python
s = pd.Series(data = np.random.randn(6),
              index = [['m','m', 'f', 'f', 'u', 'u'],
                        [1, 2, 3, 1, 2, 3])
s
```
![image](https://github.com/user-attachments/assets/da3808a3-1526-45c3-a36c-9f413c5a14c6)

```python
s.index    # MultiIndex: 튜플들을 원소로 갖는 배열.
```
![image](https://github.com/user-attachments/assets/48fb6e7d-4d09-46d3-9366-45dd70ad072b)

```python
s.index.nlevels
```
![image](https://github.com/user-attachments/assets/bc611099-878c-405e-aedb-977ed9b755a0)

## Indexing, Slicing

nlevels(인덱스의 계층 개수)가 2이상인 MultiIndex를 사용해서 loc 속성을 이용할 때,

<br>
- 첫번째 레벨의 인덱스만 가지고 indexing, slicing을 할 수 있음.<br>
- 두번째 이상의 인덱스만 가지고는 indexing, slicing을 할 수 없음!<br>
- 튜플 형태의 인덱스로 indexing, slicing이 가능.<br>
<br>

```python
# indexing
s.loc['m']    # s['m']
```

![image](https://github.com/user-attachments/assets/39c970e1-0ed7-4cd1-971f-ab81eac7e9c3)

```python
# slicing
# s.loc['m', 'f']    # UnsortedIndexError 발생
```

```python
# s.loc[1]    # KeyError 발생
s.loc[('m', 1)]    # 튜플 타입 인덱스는 사용 가능
```
![image](https://github.com/user-attachments/assets/f547a3ef-453f-4e34-bd68-4be669e5e818)

```python
s.loc[[('m', 1), ('f', 1)]]
```
![image](https://github.com/user-attachments/assets/be4ba8d4-c1e1-4315-bfbb-bb1a61e0e6f7)

```python
# s.loc[[('m', 1):('f', 3)]]    # UnsortedIndexError 발생
```

- pd.Series.sort_values(): 값들을 정렬<br>
- pd.Series.sort_index(): 인덱스들을 정렬
<br>

```python
s
```
![image](https://github.com/user-attachments/assets/575f518f-e806-4ddb-b218-ae1f3a821ab8)

```python
s_idx_sort = s.sort_index()
s_idx_sort
```
![image](https://github.com/user-attachments/assets/affacec2-c218-444a-bf74-ff5338fefb9b)

```python
s_idx_sort['f':'m']    # 인덱스들을 정렬한 후에는 slicing이 가능
```
![image](https://github.com/user-attachments/assets/98074cf8-10df-402c-b065-3d1bdbc9a0c7)

```python
s_idx_sort[('f', 2):('m', 2)]
```
![image](https://github.com/user-attachments/assets/df9b268a-c29a-432d-9095-39a9991ec24c)

## index swapping
<br>
인덱스의 레벨을 바꾸는 것.

```python
s
```
![image](https://github.com/user-attachments/assets/eeb62630-6e05-4469-a77b-36b161955f22)

```python
# s.swaplevel(i = 0, j = 1)
s_swap = s.swaplevel().sort_index()
s_swap
```
![image](https://github.com/user-attachments/assets/ee04297d-09db-45a0-84bd-f73b1e1aa904)

```python
s_swap.loc[1]
```
![image](https://github.com/user-attachments/assets/a0061b8f-3f63-4d45-bdc1-51122fa55157)

```python
s_swap.loc[1:2]
```
![image](https://github.com/user-attachments/assets/7c5e38ce-898c-4119-bc40-a83344d9b094)

```python
# nlevels = 3인 인덱스를 갖는 시리즈
s = pd.Series(data = np.random.rand(6),
              index = [np.arange(1, 7),
                        ['A', 'A', 'A', 'B', 'B', 'B'],
                        ['aa', 'bb', 'aa', 'bb', 'aa', 'bb']])
s
```
![image](https://github.com/user-attachments/assets/67ef2f5f-bdb1-4ead-905b-eb7017cdeec5)

```python
s.index
```
![image](https://github.com/user-attachments/assets/b2b4ade1-d4c4-41d7-9e18-ee96abb31a7d)

```python
s.index.nlevels
```
![image](https://github.com/user-attachments/assets/c6cdb0b9-af7e-4891-a2d1-853cb76d2931)

```python
s.swaplevel(i = 0, j = 2)
```
![image](https://github.com/user-attachments/assets/f2bd92f7-162d-4c26-b53b-46efe841da17)

```python
s.swaplevel()    # i = -2, j = -1 기본값: 마지막 인덱스와 끝에서 두번째 인덱스를 서로 바꿈.
```
![image](https://github.com/user-attachments/assets/f51ada63-3e2a-4f2b-a838-d24f18077e29)

```python
s.swaplevel(i = 0, j = 1)
```
![image](https://github.com/user-attachments/assets/ad5ddaf3-cc21-416f-82e4-3192bdf10aa5)

# DataFrame 계층적 인덱스

```python
df = pd.DataFrame(data = np.random.rand(6, 3),
                  columns = ['a', 'b', 'c'],
                  index = [['Fri', 'Fri', 'Sat', 'Sat', 'Sun', 'Sun'],
                           ['Lunch', 'Dinner'] * 3])
df
```
![image](https://github.com/user-attachments/assets/adb618db-52ef-466d-ae6d-319b2ce3920c)

```python
df.values    # DataFrame의 값들로 이루어진 2차원 ndarray
```
![image](https://github.com/user-attachments/assets/ecc77f49-65fb-4995-8b2b-26222c33c7d1)

```python
df.index
```
![image](https://github.com/user-attachments/assets/5e6e9ee0-53d2-4dff-85d6-1a9c1539ee66)

```python
df.index.nlevels
```
![image](https://github.com/user-attachments/assets/d9c3d6d9-e3c6-4860-aaa6-db9dc333f453)

```python
df.loc['Fri']    # indexing
```
![image](https://github.com/user-attachments/assets/91639f33-95ae-41ef-b0d5-cb27699f97ef)

```python
df.loc['Fri':'Sat']    # slicing
```
![image](https://github.com/user-attachments/assets/d298f23d-cca8-4c11-9b42-6a3d0f28bb99)

```python
# df.loc['Lunch']   # KeyError 발생 - 두번째 레벨의 인덱스로는 인덱싱을 할 수 없음.
```
```python
df
```
![image](https://github.com/user-attachments/assets/c3a44fe3-3351-4fc8-bf83-2566d4c3df19)

```python
df_swap = df.swaplevel()
df_swap
```
![image](https://github.com/user-attachments/assets/6ea438cd-dc16-4e8c-88b9-09358e8defca)

```python
df_swap.loc['Lunch']
```
![image](https://github.com/user-attachments/assets/c9fe2425-4577-4aa3-9201-3c67e08f1e5f)

# DataFrame 컬럼 <--> Row 레이블
<br>
- pd.DataFrame.set_index(): 데이터프레임의 컬럼(들)을 인덱스(row 레이블)로 변환한 데이터프레임을 리턴.<br>
- pd.DataFrame.reset_index(): 데이터프레임의 인덱스(들)을 컬럼으로 변환한 데이터프레임을 리턴.
<br>

## reset_index

```python
df
```
![image](https://github.com/user-attachments/assets/dabd2ae9-65da-416b-9f4c-84e8aed03fbf)

```python
df.reset_index()    # level = None 기본값: 모든 레벨의 인덱스를 컬럼으로 변환.
```
![image](https://github.com/user-attachments/assets/c75e274f-6c63-4ec8-9f45-e9db718474cd)

```python
df.reset_index(names = ['day', 'time'])    # 인덱스를 컬럼으로 변환할 때 컬럼의 이름을 설정.
```
![image](https://github.com/user-attachments/assets/bbe4d27e-54f9-4067-9673-7a5ab7640e21)

```python
df.reset_index(level = 1)    # 레벨 1의 인덱스만 컬럼으로 변환.
```
![image](https://github.com/user-attachments/assets/27351738-8dea-454d-bc34-8bf129419df6)

```python
df.reset_index(level = [0, 1])    # level = [1, 0]해도 같은 결과
```
![image](https://github.com/user-attachments/assets/f4345c66-61cb-4130-9151-fe801e61e48e)

## set_index
```python
exam = pd.DataFrame(data = {
        'class': [1] * 5 + [2] * 5,
        'id': np.arange(1, 11),
        'math': np.random.randint(101, size = 10),
        'science': np.random.randint(101, size = 10)
})
exam
```
![image](https://github.com/user-attachments/assets/29be8b90-1828-4fd5-ac34-02e5e51ad3a2)

```python
# class = 1인 데이터
exam[exam['class'] == 1]
```
![image](https://github.com/user-attachments/assets/c20831db-d007-450b-ac6e-09ea4b16a380)

```python
exam_class = exam.set_index(keys = 'class')
exam_class
```
![image](https://github.com/user-attachments/assets/4325ef63-61dd-4924-87fc-9a9b595398b8)

```python
exam_class.loc[1]
```
![image](https://github.com/user-attachments/assets/c84d2abb-c895-48f0-9080-25d65edb01cf)

```python
exam_class_id = exam.set_index(keys = ['class', 'id'])
exam_class_id
```
![image](https://github.com/user-attachments/assets/09c87afb-c999-4ae0-9d69-f03c400fa33c)

```python
exam_class_id.reset_index(level = 'class')    # exam_class_id.reset_index(level = 0)
# 인덱스가 이름을 가지고 있는 경우 reset_index 메서드의 level 파라미터로 문자열(들의 리스트)를 줄 수 있음.
```
![image](https://github.com/user-attachments/assets/97eafd00-38d5-4424-a456-5dc804030854)

<br>
reset_index 예
<br>

```python
exam
```

![image](https://github.com/user-attachments/assets/6825d032-1a4d-4f3c-9aeb-fc967f7fdc93)

```python
# exam 데이터프레임에서 반별 과목들의 평균
exam_by_class = exam.groupby(by = ['class'])[['math', 'science']].mean()
exam_by_class
```
![image](https://github.com/user-attachments/assets/c5fd8c3f-9e1d-46ef-8ff4-43a32da34ed4)

```python
exam_by_class.reset_index()
```
![image](https://github.com/user-attachments/assets/81f01770-37a4-40fb-af96-5aab9372b49a)

---
# DataFrame 모양(shape)변경

<br>
- wide (columns) --> long (rows) <br>
- long (rows) --> wide (columns)
<br>

# stack vs unstack

```python
df = pd.DataFrame(data = np.arange(1, 7).reshape((2, 3)),
                  columns = ['a', 'b', 'c'],
                  index = ['x', 'y'])
df
```

![image](https://github.com/user-attachments/assets/3e786154-e76d-4377-b1e4-92a3edd068ad)

```python
df_stacked = df.stack()
df_stacked    # 컬럼 이름들이 index(row label)로 바뀜.
```
![image](https://github.com/user-attachments/assets/2b59b199-f0a1-47b0-9991-395c49ff7f5f)

```python
df_unstacked = df_stacked.unstacked()
df_unstacked    # 가장 마지막 레벨의 인덱스를 컬럼으로 변환. long --> wied
```
```python
df_stacked.unstack(level = 0)
```
![image](https://github.com/user-attachments/assets/3e77e1b3-4371-41b3-9557-f7899a5a2b4d)
<br>
컬럼 이름(인덱스)가 MultiIndex인 경우

```python
df = pd.DataFrame(data = np.arange(1, 13).reshape((2, 6)),
                  columns = [['Lunch'] * 3 + ['Dinner'] * 3,
                             ['Fri', 'Sat', 'Sun'] * 2])
df
```
![image](https://github.com/user-attachments/assets/e262fd70-c701-40fa-8f21-3d4782d99df9)

```python
df.columns    # MultiIndex
```
![image](https://github.com/user-attachments/assets/4018a663-8630-47ea-9ca9-272362cc9256)

```python
df.stack()    # 가장 마지막 레벨의 컬럼 이름들을 index(row label)로 변
```
![image](https://github.com/user-attachments/assets/36a0745c-484d-4ffb-a387-8e10256e97dd)

```python
df.stack(level = 0)
```
![image](https://github.com/user-attachments/assets/3c062b72-5425-4480-b4fd-db43627237fd)

```python
df.stack(level = [0, 1])
```
![image](https://github.com/user-attachments/assets/04eef8b6-3fad-4000-bbbc-05a188d2aedc)

# pivot vs melt

```python
df = pd.DataFrame(data = {
    'time': ['Lunch'] * 3 + ['Dinner'] * 3,
    'day': ['Fri', 'Sat', 'Sun'] * 2,
    'tip': np.arange(1, 7),
    'total_bill': np.arange(10, 70, 10)
})
df
```

![image](https://github.com/user-attachments/assets/2bfa26ba-9c3c-478c-8fc4-7d9db9193638)

## pivot

`pd.DataFrame.pivot()` 메서드 파라미터:<br>
- columns: pivoting 데이터프레임(변환될 새로운 데이터프레임)에서 컬럼 이름으로 사용하기 위한 컬럼(들)의 이름.<br>
- index: pivoting 데이터프레임에서 인덱스(row label)로 사용하기 위한 컬럼(들)의 이름.<br>
- values: pivoting 데이터프레임의 각 셀에 채울 값들을 가지고 있는 컬럼(들) 이름.<br>

```python
df.pivot(columns = 'day', index = 'time', vlaues = 'tip')
```
![image](https://github.com/user-attachments/assets/7f1216a6-92d7-4205-8971-5ab1b1b89a29)

```python
df
```
![image](https://github.com/user-attachments/assets/cc4b1278-c0aa-43be-8002-1058b6ebc9ee)

```python
df.pivot(columns = 'time', index = 'day', values = 'total_bill')
```
![image](https://github.com/user-attachments/assets/bbdd8d85-20d7-481b-94e5-b21b4c8ade88)

## melt

```python
df = pd.DataFrame(data = {
    'gender': ['Female', 'Male'],
    'lunch': [10, 7],
    'dinner': [20, 30]
})
df
```
![image](https://github.com/user-attachments/assets/2b88eb5e-7310-4e97-b1e3-ec5fc1fbc8ff)
<br>
`pd.DataFrame.melt()` 메서드 파라미터:

* id_vars: melting될 때 컬럼으로 유지될 컬럼(들) 이름.
    * id_vars에 설정하지 않은 컬럼 이름들은 variable 컬럼으로 melting됨.
    * id_vars에 설정하지 않은 컬럼들의 모든 셀에 있는 값들은 value 컬럼으로 melting됨.
* var_name: variable 컬럼의 이름을 사용할 문자열.
* value_name: value 컬럼의 이름으로 사용할 문자열.

```python
df.melt(id_vars = 'gender')
```
![image](https://github.com/user-attachments/assets/795fcf51-fb0f-4c3d-8392-5475bd155c2d)

```python
df.melt(id_vars = 'gender', var_name = 'time', value_name = 'count')
```
![image](https://github.com/user-attachments/assets/f62cd972-0cea-4779-8af7-585dad08849d)

# pivot_table

<br>
groupby 연산과 통계 함수 적용 결과를 unstack하는 함수
<br>

```python
tips = sns.load_dataset('tips')
```

```python
tips.head()
```

![image](https://github.com/user-attachments/assets/07423fcf-6b70-408a-9a6e-55e613b75555)

## 성별 팁의 평균
```python
tips.groupby(by = ['sex']).tip.mean()
```
![image](https://github.com/user-attachments/assets/02aceb92-c152-4407-b59a-f376ee3ef16c)

```python
tips.pivot_table(value = 'tip', index = 'sex')    # aggfunc = 'mean' 기본값
```
![image](https://github.com/user-attachments/assets/c27babc5-d16f-483f-8bb3-8fde60927c9b)

##성별, 흡연여부별 tip의 평균
```python
by_sex_smoker = tips.groupby(by = ['sex', 'smoker']).tip.mean()
by_sex_smoker
```
![image](https://github.com/user-attachments/assets/547c43f6-c74c-413e-86c8-678ff5e42356)

```python
by_sex_smoker.unstack()
```
![image](https://github.com/user-attachments/assets/a5db549d-2bda-47ae-907b-27048bfcc315)

```python
tips.pivot_table(value = 'tip', index = ['sex', 'smoker'])
```
![image](https://github.com/user-attachments/assets/be2dcd30-6ed0-489c-b5c6-dbf1c3e05f4c)

```python
tips.pivot_table(value = 'tip', index = 'sex', columns = 'smoker')
```
![image](https://github.com/user-attachments/assets/bc19ef1b-3df4-498d-9a42-5cb4c6422739)

## 성별 팁, 영수증 평균

```python
by_sex = tips.groupby(by = ['sex'])[['tip', 'total_bill']].mean()
by_sex
```
![image](https://github.com/user-attachments/assets/f17410c8-2666-4ff2-bab3-7295494363ec)

```python
tips.pivot_table(values = ['tip', 'total_bill'], index = 'sex')
```
![image](https://github.com/user-attachments/assets/1fdf9fb2-98b4-482e-815f-8204bea149cd)

## 성별, 흡연여부별 팁, 영수증 평균

```python
by_sex_smoker = tips.groupby(by = ['sex', 'smoker'])[['tip', 'total_bill']].mean()
by_sex_smoker
```
![image](https://github.com/user-attachments/assets/856e1c3d-20b0-43ff-9568-05e408d39b29)

```python
by_sex_smoker.unstack()
```
![image](https://github.com/user-attachments/assets/7823f368-0112-4cb0-ba31-daec2508f88e)

```python
tips.pivot_table(values = ['tip', 'total_bill'], index = ['sex', 'smoker'])
```
![image](https://github.com/user-attachments/assets/7dea9ab1-6457-4377-a9ce-a0a4b87025df)

```python
tips.pivot_table(values = ['tip', 'total_bill'], index = 'sex', columns = 'smoker')
# pivot테이블 함수는 한번에 끝내기 가능. group by는 unstack까지 해줘야 함  
```
![image](https://github.com/user-attachments/assets/e5e1b192-f601-40cc-965e-4d9c495a2aa5)

## Ex 1. 성별, 요일별, 시간별 팁의 평균
```python
result = tips.groupby(by = ['sex', 'day', 'time']).tip.mean()
result
```
![image](https://github.com/user-attachments/assets/636c89f7-3559-4a87-bbf0-c4d37488b5d7)

```python
result.unstack()
```
![image](https://github.com/user-attachments/assets/75156332-383e-4748-a5fd-eb22aa96570c)

```python
result.unstack(level = 1)
```
![image](https://github.com/user-attachments/assets/237b615d-8be2-4553-a916-f3b7e56007ab)

```python
tips.pivot_table(values = 'tip', index = ['sex', 'day', 'time'])
```
![image](https://github.com/user-attachments/assets/20422f74-f777-4bd5-8ec3-4165e138aabe)

```python
tips.pivot_table(values = 'tip', index = ['sex', 'day'], columns = 'time')
```
![image](https://github.com/user-attachments/assets/a628a30d-377e-4b09-a551-10a03019cbd9)

```python
tips.pivot_table(values = 'tip', index = ['sex', 'time'], columns = 'day')
```
![image](https://github.com/user-attachments/assets/92eb692d-644d-48ac-9001-3fa86bcb6839)

## Ex 2. 성별 팁의 최솟값, 중위값, 최댓값
```python
tips.groupby(by = ['sex']).tip.agg(['min', 'median', 'max'])
```
![image](https://github.com/user-attachments/assets/5d244c1e-3ecd-42c7-9fdc-b4d5fcccae2e)

```python
tips.pivot_table(values = 'tip', index = 'sex', aggfunc = ['min', 'median', 'max'])
```
![image](https://github.com/user-attachments/assets/f4fb6fed-3613-43a9-b4d2-b1505986aa2e)

## Ex 3. 성별, 요일별 영수증 최솟값, 중위값, 최댓값

```python
result = tips.groupby(by = ['sex', 'day']).tip.agg(['min', 'median', 'max'])
result
```
![image](https://github.com/user-attachments/assets/8582372f-f825-4b43-aa86-28c33d46df9a)

```python
result.unstack()
```
![image](https://github.com/user-attachments/assets/41f63d2b-5fa0-4ad3-886b-a171ec25b068)

```python
result.unstack(level = 0)
```
![image](https://github.com/user-attachments/assets/22ba2d33-23e8-415f-b633-6a5ac39d2efd)

```python
tips.pivot_table(values = 'tip', index = ['sex','day'], aggfunc = ['min', 'median', 'max'] )
```
![image](https://github.com/user-attachments/assets/c1b04e9e-9d1d-4df8-8067-0fd39abeb99a)

```python
tips.pivot_table(values='tip', index='sex', columns='day', aggfunc=['min', 'median', 'max'])
```
![image](https://github.com/user-attachments/assets/5e3e8ad3-abe3-4bbe-99fd-d033b1bba69d)

```python
tips.pivot_table(values='tip', index='day', columns='sex', aggfunc=['min', 'median', 'max'])
```
![image](https://github.com/user-attachments/assets/5c0591f4-6570-4f1a-9d56-cab5ab8a2452)

## Ex 4. 성별, 흡연여부별, 요일별 팁의 중위값

```python
result = tips.groupby(by = ['sex', 'smoker', 'day']).tip.median()
result
```
![image](https://github.com/user-attachments/assets/fb104e8e-ba0a-4c4d-9983-4ebc4e0c126b)

```python
result.unstack()    # 요일을 unstack하는 방법
```
![image](https://github.com/user-attachments/assets/4352e951-9af1-451c-b910-b41c56619427)

```python
result.unstack(level = 0)
```
![image](https://github.com/user-attachments/assets/d45ae7fc-269c-4f2f-a59d-736f72e83cd6)

```python
result.unstack(level=1)
```
![image](https://github.com/user-attachments/assets/fd09c81a-357f-4eb2-94e6-ea8ca2ea943b)

```python
result.unstack(level = [0, 1])
```
![image](https://github.com/user-attachments/assets/4a318fc3-c668-4a88-b335-2a91ec4d9444)

```python
tips.pivot_table(values = 'tip', index = ['sex', 'smoker', 'day'], aggfunc = 'median')
```
![image](https://github.com/user-attachments/assets/d05d0469-38ad-4ac8-92bd-a1fd96acf480)

```python
tips.pivot_table(values='tip', index=['sex', 'smoker'], columns='day', aggfunc='median')
```
![image](https://github.com/user-attachments/assets/08f8d8e5-555a-4b43-84c8-3d8080d4146d)

```python
tips.pivot_table(values='tip', index=['sex', 'day'], columns='smoker', aggfunc='median')
```
![image](https://github.com/user-attachments/assets/e82b7904-c1ff-478c-8b19-71bd8d9193d3)

```python
tips.pivot_table(values='tip', index='day', columns=['sex', 'smoker'], aggfunc='median')
```
![image](https://github.com/user-attachments/assets/c5b32f5f-a3b1-44ce-8293-7805ee112320)

## Ex 5. 성별, 흡연여부별, 요일별, 시간별 팁의 중앙값

```python
result = tips.groupby(by = ['sex', 'smoker', 'day', 'time']).tip.median()
result
```
![image](https://github.com/user-attachments/assets/4f02f3e9-62da-423e-846b-664acb44e450)

```python
result.unstack(level = ['day', 'time'])    # 인덱스에 이름이 있으면 사용 가능
```
![image](https://github.com/user-attachments/assets/1cabfa80-5f8f-44dd-953a-06e4af99dfa9)

```python
tips.pivot_table(values = 'tip', index = ['sex', 'smoker'], columns = ['day', 'time'], aggfunc = 'median')
```
![image](https://github.com/user-attachments/assets/1ac3d45b-de56-4c4b-a9da-5457778e6e5d)

```python
tips.pivot_table(values = 'tip', index = ['day', 'time'], columns = ['sex', 'smoker'], aggfunc = 'median')
```
![image](https://github.com/user-attachments/assets/32e98348-8f21-4a1d-988d-345e2a4bea95)
