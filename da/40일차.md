### seaborn 모듈에서 iris 데이터셋을 로드, 표준화

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```
```python
iris = sns.load_dataset('iris')
iris.head()
```
![image](https://github.com/user-attachments/assets/b124aecd-adf4-4927-bf07-4d6b0d37024f)

```python
# iris DataFrame에 species 컬럼 삭제
iris_features = iris.drop(columns = 'species')
iris_features.head()
```
![image](https://github.com/user-attachments/assets/9b11d829-5657-4f4c-ad69-c92c05e8144e)

```python
# DataFrame.values 속성: DataFrame의 값들을 ndarray로 저장한 속성.
X = iris_features.values
```
```python
X[:5, :]
```
![image](https://github.com/user-attachments/assets/461e7fae-0925-422a-bde8-9c73b92f0a87)
<br>
axis = 0 축을 따라서 표준화(평균 = 0, 표준편차 = 1)
<br>
```python
mu = np.mean(X, axis = 0, keepdims = True)
mu
```
![image](https://github.com/user-attachments/assets/1d43ed37-5199-4830-8abb-b3e658ff0f6e)

```python
sigma = np.std(X, axis = 0, keepdims = True)
sigma
```
![image](https://github.com/user-attachments/assets/65c68ea9-d5e0-416e-9107-3a8fe01928db)

```python
X_std = (X - mu) / sigma
```
```python
X_std[:5, :]
```
![image](https://github.com/user-attachments/assets/028c4ab8-bd2b-4528-b362-0e7cc99a06c4)
<br>
axis = 0 축을 따라서 정규화(최솟값 = 0, 최댓값 = 1)
<br>
```python
X_min = np.min(X, axis = 0, keepdims = True)
X_min
```
![image](https://github.com/user-attachments/assets/24cb00fd-9f59-44ed-900a-0bff9cee80cd)

```python
X_max = np.max(X, axis = 0, keepdims = True)
X_max
```
![image](https://github.com/user-attachments/assets/607c9fe9-b983-4813-8518-bd09641f758a)

```python
X_norm = (X - X_min) / (X_max - X_min)
X_norm[:5, :]
```
![image](https://github.com/user-attachments/assets/f93ef595-9354-4301-904d-fe5f7cecf4c2)

# 행렬 곱(matrix multiplication)

*   `@` 연산자: 1차원 배열, 2차원 배열에서 사용 가능.
*   `np.matmul()` 함수: n차원 배열에서 사용 가능.

## 1차원 배열의 행렬 곱

```python
a = np.array([1, 2, 3])
b = np.array([4, 5, 6])
```
```python
print(a)
```
![image](https://github.com/user-attachments/assets/e697ce0c-d16a-40ab-97dc-e9224bb858cf)

```python
print(b)
```
![image](https://github.com/user-attachments/assets/141f8e69-22c1-43cd-9efb-8fa4e8fcd165)

```python
a @ b
```
![image](https://github.com/user-attachments/assets/3e0dc0e1-26cd-4383-bd44-6df001b1b4e2)

```python
np.matmul(a, b)
```
![image](https://github.com/user-attachments/assets/13aaaf9e-3988-440e-8d40-7e56d02c7494)

## 2차원 배열의 행렬 곱
`(i, j) @ (j, k) -> (i, k)`

```python
A = np.arange(1, 7).reshape((2, 3))
print(A)
```
![image](https://github.com/user-attachments/assets/57373e59-2fc5-437e-a110-6ce78063c9c3)

```python
B = np.ones(shape = (3, 2), dtype = np.int64)
print(B)
```
![image](https://github.com/user-attachments/assets/85925acf-7813-484e-b021-a4937f03a279)

```python
A @ B
```
![image](https://github.com/user-attachments/assets/d4f702f2-26b8-40ca-abce-afd1969f67d2)

```python
np.matmul(A, B)
```
![image](https://github.com/user-attachments/assets/843bbdc0-17d8-443f-9f58-ed10fe5e6a55)

```python
A = np.arange(1, 13).reshape((3, 4))
print(A)
```
![image](https://github.com/user-attachments/assets/de25ffeb-8577-4fc7-ac7a-26cccec41323)

```python
B = np.array([
    [1, 1],
    [2, 2],
    [1, 2],
    [2, 3]
])
print(B)
```
![image](https://github.com/user-attachments/assets/87b75fcf-8d4b-4ca2-a576-f41f78636f9a)

```python
A @ B
```
![image](https://github.com/user-attachments/assets/f3677586-2d26-4e76-ae03-cc870947e82b)

```python
np.matmul(A, B)
```
![image](https://github.com/user-attachments/assets/4359709b-8b64-41f6-a864-2673ae4ae228)

## 2차원 배열과 1차원 배열에서의 행렬 곱
```
(i, j) @ (j,) -> (i,)       # 2D array @ 1D array -> 1D array
(i, j) @ (j, 1) -> (i, 1)   # 2D array @ 2D array -> 2D array 
```

```python
A = np.arange(1, 7).reshape((2, 3))
print(A)
```
![image](https://github.com/user-attachments/assets/4a55dd6d-b05c-46a9-b391-562dd51df8bd)

```python
b = np.arange(1, 4)  # 자동으로 (3, 1)처럼 간주돼서 가능
print(b)
```
![image](https://github.com/user-attachments/assets/aa508250-5ebd-428d-87eb-000fa134692a)

```python
A @ b
```
![image](https://github.com/user-attachments/assets/e2c506e0-0e26-473d-a9d5-ca929a0fa13d)

```python
np.matmul(A, b)
```
![image](https://github.com/user-attachments/assets/be46d356-111b-4150-9ca1-1d23f78bb6f2)

```python
B = b.reshape((3, -1))
print(B)
```
![image](https://github.com/user-attachments/assets/5a78b15c-84dc-4bef-b2c1-af7f8f4b9870)

```python
A @ B
```
![image](https://github.com/user-attachments/assets/bdd2a359-ca69-4aff-9864-b9b249a535c2)

```python
np.matmul(A, B)
```
![image](https://github.com/user-attachments/assets/f57a2cca-4dac-405e-8cc0-6be97017a0d1)

------
```python
# sklearn(scikit-learn) 모듈의 neighbors 하위 모듈에서 KNeighborsClassifier 클래스를 임포트
from sklearn.neighbors import KNeighborsClassifier
```

# 데이터 준비
```python
file_path = 'https://github.com/JakeOh/202505_BD50/raw/refs/heads/main/datasets/fish.csv'
fish = pd.read_csv(file_path)
fish.head()
```
![image](https://github.com/user-attachments/assets/0ce594b7-7c97-4e67-aaf9-ef8aa9daaf8b)

## 데이터 탐색
```python
fish.info()
```
![image](https://github.com/user-attachments/assets/f194460c-1bf5-4827-8003-e44c18537281)

```python
fish.Species.value_counts()
```
![image](https://github.com/user-attachments/assets/753f47b6-58ee-4901-a200-571fb28d91ad)

## 카테고리 변수
```python
sns.countplot(data = fish, y = 'Species',
              order = fish.Species.value_counts().index)
plt.show()
```
![image](https://github.com/user-attachments/assets/4f1533b9-fd6c-4b88-a364-b8c5bc072d6c)

## 숫자 타입 변수 탐색

<br>
어종을 제외한 5개 변수의 box plot, histogram을 그려보세요.
<br>

```python
features = fish.columns[1:]
print(features)
```
![image](https://github.com/user-attachments/assets/7ff15076-a12a-43a4-bc02-b47b46734e7b)

```python
fig, axes = plt.subplot(ncols = len(features), figsize = (20, 4))

for i, var in enumerate(features):
    sns.histplot(data = fish, x = var, ax = axes[i])

plt.show()
```
![image](https://github.com/user-attachments/assets/45ce968a-e63b-4bf6-8a7d-f8edc1d05e3c)

```python
fig, axes = plt.subplot(ncols = len(features), figsize = (20, 4))

for i, var in enumerate(features):
    sns.boxplot(data = fish, y = var, ax = axes[i])

plt.show()
```
![image](https://github.com/user-attachments/assets/aaf88439-c19d-49ab-a0cb-9bf4523cb36a)

## 변수들 간의 상관관계 시각화
```python
sns.pairplot(data = fish)
plt.show()
```
![image](https://github.com/user-attachments/assets/f486265e-46b5-44f6-940d-1a5942630af8)

```python
sns.pairplot(data = fish, hue = 'Species')
plt.show()
```
![image](https://github.com/user-attachments/assets/0c2276a4-8ae6-464d-8022-5269607c8d61)

# 문제 정의

2개 변수를 사용한 2진 분류 문제
*   Bream(도미), Smelt(빙어) 분류 - 2진 분류(binary class classification)
*   특성(변수) - Weight(무게), Length(길이)

```python
# Jupyter 노트북에서 데이터프레임을 출력할 때 행을 최대 10개까지만 출력.
pd.options.display.max_rows = 10
```
```python
# fish 데이터프레임에서 Bream(도미)과 Smelt(빙어)를 선택, 3개 컬럼 선택.
df = fish.loc[fish.Species.isin(['Bream', 'Smelt']), ['Species', 'Weight', 'Length']]
df
```
![image](https://github.com/user-attachments/assets/26cd1cea-e1bf-4887-8521-a2bdead50980)

```python
df.Species.value_counts()
```
![image](https://github.com/user-attachments/assets/e07c1c70-9781-41cd-b5ad-06dc577225af)

```python
sns.countplot(data = df, x = 'Species')
plt.show()
```
![image](https://github.com/user-attachments/assets/34b880e4-8adf-4639-9541-f2385dffc8bb)

```python
sns.scatterplot(data = df, x = 'Length', y = 'Weight', hue = 'Species')
plt.show()
# 그래프 보면 두개의 물고기는 구분하기 쉬움
```
![image](https://github.com/user-attachments/assets/53ff90e6-5395-42d5-aa72-ca3a86e110f0)
<br>
scikit-learn 패키지의 머신러닝 알고리즘(클래스)들은 데이터(특성, 변수)과 레이블(타겟) 배열을 구분해서 사용함.
<br>
특성 배열은 2차원 ndarray, 타겟 배열은 1차원 ndarray.
<br>

```python
# 특성 배열(2d array)
X = df[['Weight', 'Length']].values    # values는 선택한 열들을 넘파이 배열로 바꿔줌(넘파이 배열로 바꿔야 모델에 바로 넣기 편함) 
```
```python
X[:5, :]
```
![image](https://github.com/user-attachments/assets/0fa0454e-3e21-4803-81a3-7ef9aa9447c8)

```python
# 타겟 배열(1d array)
y = df['Species'].values    # 기츨문제 답
y
```
![image](https://github.com/user-attachments/assets/6d65516f-e1eb-4dec-965b-4d3e2c59b960)
<br>

# KNN 모델 훈련
<br>
KNN(K-Nearest Neighbors, K-최근접 이웃) 알고리즘

<br>
*   k개의 가장 가까운 이웃들의 레이블(도미냐 빙어냐..)을 사용해서 예측하는 머신 러닝 모델.(가장 좋은 k값을 찾아내는거)<br>
*   KNN 분류 모델은 학습 시간이 필요하지 않음.<br>
*   KNN 분류 모델은 예측할 때 학습(훈련) 데이터와 테스트 데이터 사이의 거리를 계산한 후 가장 가까운 k개의 거리를 찾기 때문에, 예측 시간이 오래 걸릴 수 있음.
<br>

```python
# KNN 객체를 생성
# 파라미터 기본값: n_neighbors = 5(가장 가까운 이웃 5개 사용), metric = 'minkowski'(유클리드 기하학 최단거리)
knn_clf = KNeighborsClassifier()
```
```python
# 모델 훈련(학습)
knn_clf.fit(X, y)    # # fit은 모델한테 문제지, 답안지 같이 줌. (2차원 배열, 1차원 배열인 타겟 배열)
```
![image](https://github.com/user-attachments/assets/2fb403e6-d175-4419-9d53-0bf40058f779)

![image](https://github.com/user-attachments/assets/e8e13e15-3904-4c93-b709-ca751b7dc83a)


```python
# 훈련 셋의 예측값
train_pred = knn_clf.predict(X)    # 문제지(특성 배열. 무게와 길이)만 주고, 예측값 찾음
```
```python
train_pred
```
![image](https://github.com/user-attachments/assets/b8cf5db4-c3f8-4caf-b4b4-81a1230ce718)

```python
# 훈련 셋의 예측값과 실제값(타겟 -> y) 비교
train_pred == y    # 100% 정확도
```
![image](https://github.com/user-attachments/assets/d83309a2-f867-484e-be6b-4c5935bc9b07)

```python
np.mean(train_pred == y)    # 정확도 (True = 1, False = 0로 계산)
```
![image](https://github.com/user-attachments/assets/b49c8a27-a826-45e3-91bc-4a31791bc4ed)

# 가상의 데이터 예측값
<br>
(600g, 30cm), (50g, 14cm) 가상의 물고기. 
<br>

```python
X_test = np.array([
    [600, 30],
    [50, 14]
])
```
```python
X_test
```
![image](https://github.com/user-attachments/assets/c8f5ae62-1752-4c85-acef-cb51950dc76c)

```python
# 훈련 셋 시각화
sns.scatterplot(data = df, x = 'Length', y = 'Weight', hue = 'Species')

# 테스트 셋(가상의 물고기) 시각화
plt.scatter(x = X_test[:, 1], y = X_test[:, 0], color = 'red', marker = 'v')

plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/ef46bc88-876f-4c4d-a3bd-96acd58f2bf1)

```pytho
# 가상의 물고기 예측값
test_predict = knn_clf.predict(X_test)
```
```python
test_predict    # 첫번째 물고기는 'Bream', 두번째 물고기는 'Smelt'
```
![image](https://github.com/user-attachments/assets/dbf75c99-5c97-4af6-bd0c-2f7e0e91db74)

```python
distances, indices = knn_clf.kneighbors(X = X_test, n_neighbors=5)
# 리턴값 distances: 가장 가까운 이웃 k개까지의 거리들.
# 리턴값 indices: 가장 가까운 이웃 k개의 인덱스들.
```
```python
indices    # 5개의 이웃들
```
![image](https://github.com/user-attachments/assets/c4f6c23d-2ca5-4e55-9304-d15956104486)

```python
distances    # 15번 14번 물고기의 거리는 같음. 뒤로 갈수록 거리는 커짐
```
![image](https://github.com/user-attachments/assets/5835d181-31c2-4e9b-bbb2-e792cf229323)

```python
y[indices[0]]    # [15, 14, 18, 22, 20] 물고기들은 Bream
```
![image](https://github.com/user-attachments/assets/f53aee3c-9865-466e-bbf2-be80c15df619)

```python
y[indices[1]]    # [48, 47, 45, 46, 44]는 Smelt
```
![image](https://github.com/user-attachments/assets/805335b6-61b5-49e1-94a3-6600553d9325)

# k값에 따른 정확도
```python
# k = 1인 KNN 모델을 생성
knn_1 = KNeighborsClassifier(n_neighbors=1)

# 모델을 훈련
knn_1.fit(X, y)

# 훈련 셋의 예측값
train_pred_1 = knn_1.predict(X)
print(train_pred_1)

# 훈련 셋 예측값의 정확도(accuracy)
acc_1 = knn_1.score(X, y)
print(acc_1)
```
![image](https://github.com/user-attachments/assets/11101b79-64e4-4232-8e36-1de67135b0ba)

```python
# 1.0 -> 정확도 100%
```
```python
accuracies = []     # k값 변화에 따른 정확도를 저장할 빈 리스트

# 1 ~ 49 반복: KNN(k) 모델 생성 -> 훈련 -> 정확도 계산 -> 리스트에 추가
for k in range(1, 50):
    knn = KNeighborsClassifier(n_neighbors=k)   # 모델 생성
    knn.fit(X, y)   # 문제지(길이와 무게)와 답안지(도미냐 빙어냐)를 줌. 모델 훈련
    acc = knn.score(X, y)     # 훈련 셋에서의 정확도 계산(정답지와 비교를 해야 정확도 계산이 되기 때문에 실제 값을 가지고 있는 y(타켓)가 필요)
    accuracies.append(acc)      # 리스트에 정확도 추가

print(accuracies)
# k값이 무조건 크거나 작거나 좋은게 아님
```
![image](https://github.com/user-attachments/assets/7f858069-1347-4fb4-9753-e2c79ef8f2e5)

```python
k_values = np.arange(1, 50)
sns.lineplot(x = k_values, y = accuracies, marker = 'o')
plt.xlabel('k value')
plt.ylabel('accuracry')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/db37ad1d-ec94-4583-b590-437bcac04403)

```python
print(np.argmax(accuracies))    # np.argmax(arr): arr에서 최댓값의 인덱스
print(np.argmin(accuracies))    # np.argmin(arr): arr에서 최솟값의 인덱스
```
![image](https://github.com/user-attachments/assets/7b99527d-baee-454e-9d58-d32a0aa20d09)

```python
k_values[np.argmax(accuracies)]
```
![image](https://github.com/user-attachments/assets/4d1acafc-2dd0-4d24-b925-8aa30e7cadef)

```python
k_values[np.argmin(accuracies)]
```
![image](https://github.com/user-attachments/assets/e6b96cc2-3a3c-492e-a50d-79f72c7dce31)

