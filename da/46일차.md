# Imports

```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn import datasets
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.linear_model import LogisticRegression, SGDClassifier
from sklearn.preprocessing import StandardScaler, PolynomialFeatures
from sklearn.pipeline import Pipeline
from sklearn.metrics import confusion_matrix, classification_report
from sklearn.metrics import RocCurveDisplay, PrecisionRecallDisplay
```

# 이진 분류(Binary class classification)

Breast cancer 데이터셋에서 악성종양(malignant)과 양성종양(benign)을 분류

## 데이터셋 준비

```python
cancer = datasets.load_breast_cancer()    # Bunch 클래스 타입 - python의 dict를 가지고 있는 객체
```
```python
cancer.key()
```
<img width="763" height="33" alt="image" src="https://github.com/user-attachments/assets/c1d880af-5be3-489a-b16d-c7a84c5adfc0" />

```python
print(cancer.DESCR)  # cancer['DESCR']
# 데이터 셋에 대한 설명
# Instances -> 데이터(행)가 569개 있다는거
# 30개의 숫자 타입(컬럼 30개)
# Missing Attribute Values: None -> None은 없다
# 암인지 암이 아닌지 분류하는 문제
# class는 WDBC-Malignant,WDBC-Benign 두 개
```
<img width="491" height="791" alt="image" src="https://github.com/user-attachments/assets/35713408-6ff7-4d09-b7ed-323b5c4e64fa" />

<img width="487" height="756" alt="image" src="https://github.com/user-attachments/assets/1ef7e905-9cf6-4bff-889d-09fcb2a658bf" />

```python
cancer.feature_names    # cancer['feature_names']
```
<img width="523" height="168" alt="image" src="https://github.com/user-attachments/assets/25bc2609-cab4-459a-8f8b-fc1ef5d45793" />

```python
cancer.target_names    # 암이다, 암이 아니다
```
<img width="314" height="30" alt="image" src="https://github.com/user-attachments/assets/eed70047-d488-4414-8bd5-8e22a5cd373f" />

```python
X = cancer.data    # 특성 배열(2차원 배열)
y = cancer.target  # # 타겟 배열(1차원 배열)
```
```python
X.shape    # (samples, features)
```
<img width="72" height="30" alt="image" src="https://github.com/user-attachments/assets/8ae5ae33-0d64-4908-bc1b-992255b98a36" />

```python
y.shape    # (samples,)
```
<img width="55" height="27" alt="image" src="https://github.com/user-attachments/assets/07889949-9b37-4ae4-8d7a-1d5348dc45b7" />

```python
X[:3, :]    # 1차원 배열 안에 30개의 데이터가 있음
```
<img width="535" height="243" alt="image" src="https://github.com/user-attachments/assets/7c1f2c52-a6de-4c6a-aab7-c227e2e5f0bc" />

```python
y[:10]
```
<img width="269" height="23" alt="image" src="https://github.com/user-attachments/assets/bbae8749-a1a8-4727-b73f-b13993b63591" />

```python
y[-10:]
```
<img width="272" height="30" alt="image" src="https://github.com/user-attachments/assets/2ba0a996-847f-4e0e-889a-a152d7900602" />

## 데이터 탐색(EDA, Exploratory Data Analysis)

```python
cancer_df = pd.DataFrame(data = X, columns = cancer.feature_names)
cancer_df.head()
```
<img width="1895" height="167" alt="image" src="https://github.com/user-attachments/assets/69ba2051-efea-45fc-84ab-62c33e8f466a" />

```python
cancer_df.info()
# 전부 숫자 타입
# null은 없음
```
<img width="392" height="584" alt="image" src="https://github.com/user-attachments/assets/ac21aa8e-b5d8-47ab-adad-fc11a8b7e24e" />

```python
cancer_df.describe()
```
<img width="1895" height="227" alt="image" src="https://github.com/user-attachments/assets/4ca3a6b2-b263-43af-81cd-2ac769accff3" />

```python
# 암 데이터프레임에 target 파생변수 추가
cancer_df['target'] = cancer.target
```

```python
# target(클래스)의 빈도수
np.unique(cancer_df.target, return_counts = True)
# target은 0, 1 두 가지. 각각 212, 357개
# 암(malignant) -> 0, 종양(benign) -> 1
```
<img width="251" height="25" alt="image" src="https://github.com/user-attachments/assets/0042aa97-c1dd-4859-817d-a8ec829475e4" />

```python
# target 변수의 값들을 0 -> 'malignant', 1 -> 'benign'으로 변환
cancer_df.target = np.where(cancer_df.target == 0, 'malignant', 'benign')
```
```python
sns.countplot(data = cancer_df, x = 'target')
plt.show()
```
<img width="528" height="392" alt="image" src="https://github.com/user-attachments/assets/fd28e59d-0c48-44f0-a245-886174c038ba" />


첫 5개 변수('mean radius' ~ 'mean smoothness')의 히스토그램을 그려보세요.


```python
fig, axes = plt.subplots(ncols = 5, figsize = (20, 4))

for i, col in enumerate(cancer_df.columns[:5]):
    sns.histplot(data = cancer_df, x = col, ax = axes[i])
plt.show()
```
<img width="812" height="199" alt="image" src="https://github.com/user-attachments/assets/9d2c7239-2f42-496a-9c8d-d4a4c2aa3db2" />


첫 5개 변수('mean radius' ~ 'mean smoothness')의 pairplot(hue = 'target')을 그려보세요.


```python
sub_df = cancer_df.iloc[:, [0, 1, 2, 3, 4, 30]]
```
```python
sub_df.head()
```
<img width="666" height="190" alt="image" src="https://github.com/user-attachments/assets/ed0f1f7d-5087-47ce-afb0-e3264973069c" />

```python
sns.pairplot(data = sub_df, hue = 'target')
plt.show()
```
<img width="808" height="733" alt="image" src="https://github.com/user-attachments/assets/5602b4d0-e27c-4eab-be56-183b183c2847" />

상관계수가 큰건 mean radius의 3, 4번재 그래프(직선에 가까움)

## 훈련 셋/테스트 셋 나누기

```python
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 42, stratify = y)
```
```python
X_trian.shape()
```
<img width="74" height="25" alt="image" src="https://github.com/user-attachments/assets/d26ab871-118e-462a-891e-dba1b76fd880" />

```python
X_test.shape()
```
<img width="83" height="37" alt="image" src="https://github.com/user-attachments/assets/43616dd2-bf4b-47ac-8c92-07f868c99e4e" />

```python
y_train.shape()
```
<img width="61" height="27" alt="image" src="https://github.com/user-attachments/assets/105c4b39-9495-4e80-b16c-4ca849add78a" />

```python
y_test.shape()
```
<img width="57" height="35" alt="image" src="https://github.com/user-attachments/assets/3c51b49a-35d5-41aa-afee-656184a82a4d" />

## KNN Classifier

```python
# 분류기 ML 모델 생성
knn = Pipeline(steps = [('scaler', StandardScaler()),
                        ('clf', KNeighborsClassifier())])
```
```python
knn.fit(X_train, y_train)    # 모델 훈련
```
<img width="258" height="157" alt="image" src="https://github.com/user-attachments/assets/b4ca297c-11c4-4e60-bcb1-4a804087f301" />

```python
train_pred = knn.predict(X_train)    # 훈련 셋의 예측값
```
```python
conf_mat = confusion_matrix(y_train, train_pred)    # 혼동행렬(오차행렬)
conf_mat
# 암을 암이라고 예측한게 161, 암이 아닌것을 암이 아니라고 예측한게 282개
```
<img width="143" height="49" alt="image" src="https://github.com/user-attachments/assets/8f55f2e4-973e-431e-82f7-4b13844c4551" />


seaborn 패키지의 heatmap 함수를 사용해서 혼동행렬을 시각화해보세요.


```python
sns.heatmap(data = conf_mat, cmap = 'Blues', annot = True, fmt = 'd',
            xticklabels = cancer.target_names,
            yticklabels = cancer.target_names)
```
<img width="546" height="443" alt="image" src="https://github.com/user-attachments/assets/036792fc-f644-4746-ab57-ddbed1093c5b" />

```python
print(classification_report(y_train, train_pred))
# 전체 정확도는 0.97
# 전체 455개 중에서 틀린건 12개
```
<img width="387" height="151" alt="image" src="https://github.com/user-attachments/assets/be31f19f-3237-4b5f-b53d-0ddf05bf5147" />

```python
print((161+282)/455)
print(161/(161+3)) # 정밀도
print(161/(161+9))  # recall

# 정밀도가 좋아지면 recall은 나빠진다
# recall이 좋아지면 정밀도는 나빠진다
```
<img width="149" height="61" alt="image" src="https://github.com/user-attachments/assets/0950380d-851c-484b-bbb4-af78c62bac53" />

```python
# 테스트 셋의 예측값
test_pred = knn.predict(X_test)
test_pred
```
<img width="517" height="113" alt="image" src="https://github.com/user-attachments/assets/06c7ab68-37dc-42a4-bc7c-d626e91c03af" />

```python
y_test
```
<img width="515" height="116" alt="image" src="https://github.com/user-attachments/assets/065617ec-fa95-494d-8171-a46f85765b9a" />

```python
conf_mat_test = confusion_matrix(y_test, test_pred)
conf_mat_test
```
<img width="127" height="46" alt="image" src="https://github.com/user-attachments/assets/c44353d6-c754-406c-a64b-03182cd0cdab" />

```python
sns.heatmap(data = conf_mat_test, cmap = 'Blues', annot = True, fmt = 'd',
            xticklabels = cancer.target_names, yticklabels = cancer.target_names)  # fmt = 'd' -> 정수로 쓰겠다. annot = True -> 히트맵의 각 칸에 해당하는 숫자 값이 표시됨
plt.show()
```
```python
print(classification_report(y_test, test_pred))
```
<img width="386" height="157" alt="image" src="https://github.com/user-attachments/assets/ddcf1f0c-b763-46db-ae53-5969ff534e93" />

## percision(정밀도)-recall(재현율) 곡선

*   정밀도(precision)와 재현율(recall)은 trade_off 관계가 있음.
    *   같은 정확도(accuracy)에서 정밀도가 좋아지면 재현율이 나빠지고, 재현율이 좋아지면 정밀도가 나빠짐.
*   정밀도를 y축으로, 재현율을 x축으로 설정해서 trade-off 관계를 나타낸 그래프.

```python
PrecisionRecallDisplay.from_predictions(y_test, test_pred)
plt.show()
```
<img width="450" height="435" alt="image" src="https://github.com/user-attachments/assets/9afd5d0d-cad3-4980-9f31-426a67dd949c" />

```
Precision이 1이면 recall은 0
```

## ROC(Receiver Operating Characteristic) 곡선

*   FPR을 x축으로 하고, TPR을 y축으로 설정해서 FPR과 TPR 사이의 trade-off 관계를 나타낸 곡선.
*   FPR(False Positive Rate, 가짜 양성 비율): 실제 음성 샘플들 중에서 오답(가짜 양성)의 비율.
    *   FPR = FP / (FP + TN)
*   TPR(True Positive Rate, 진짜 양성 비율): 실제 양성 샘플들 중에서 정답(진짜 양성)의 비율. 재현율(recall).
    *   TPR = TP / (TP + FN)
*   TNR(True Negative Rate, 진짜 음성 비율): 실제 음성 샘플들 중에서 정답(진짜 음성)의 비율. 특이도(specificity).
    *   TNR = TN / (FP + TN)
    *   TNR + FPR = 1
    *   TNR = 1 - FPR
    *   FPR = 1 - TNR
*   AUC(Area under curve): ROC 곡선 아래쪽의 넓이.
    *   이진 분류 성능 평가 - AUC가 1에 가까울 수록 좋은 모델.

---

<table>
    <thead>
        <tr>
            <th></th>
            <th></th>
            <th colspan="2">예측값<th/>
        </tr>
        <tr>
            <th></th>
            <th></th>
            <th>P</th>
            <th>N</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <th rowspan="2">실젯값</th>
            <th>P</th>
            <td>TP</td>
            <td>FN</td>
        </tr>
        <tr>
            <th>N</th>
            <td>FP</td>
            <td>TN</td>
        </tr>
    </tbody>
</table>

```python
RocCurveDisplay.from_estimator(knn, X_test, y_test)
plt.show()
```
<img width="455" height="437" alt="image" src="https://github.com/user-attachments/assets/6fc5ea7c-0f0a-4e9d-b700-1372beceea9d" />

## Logistic Regression

```python
logit = Pipeline(steps = [('scaler', StandardScaler()),
                          ('clf', LogisticRegression(random_state=42))])    # ML 모델 생성
```
```python
logit.fit(X_train, y_train)     # ML 모델 훈련
```
<img width="241" height="151" alt="image" src="https://github.com/user-attachments/assets/7b34b25c-9047-470f-a97f-e3a3871236cd" />

```python
train_pred = logit.predict(X_train)     # 훈련 셋 예측값
```
```python
conf_mat_train = confusion_matrix(y_train, train_pred)
conf_mat_train
```
<img width="151" height="49" alt="image" src="https://github.com/user-attachments/assets/86216706-a6a8-4c52-8891-0e358a4d36af" />

```python
sns.heatmap(data=conf_mat_train, cmap='Blues', annot=True, fmt='d',
            xticklabels=cancer.target_names, yticklabels=cancer.target_names)
plt.show()
```
<img width="521" height="415" alt="image" src="https://github.com/user-attachments/assets/ed3af6aa-949b-4a8a-96da-999b6e8cd3a3" />

```python
print(classification_report(y_train, train_pred))
# KNN 보다 훈련 결과가 좋음.
```
<img width="393" height="159" alt="image" src="https://github.com/user-attachments/assets/9c215307-5cde-414f-87d5-d6fdd99001f5" />

```python
test_pred = logit.predict(X_test)   # 테스트 셋 예측값
```
```python
conf_mat_test = confusion_matrix(y_test, test_pred)
conf_mat_test
```
<img width="130" height="40" alt="image" src="https://github.com/user-attachments/assets/f61faf12-2398-463b-8545-296dc93dbd3f" />

```python
sns.heatmap(data=conf_mat_test, cmap='Blues', annot=True, fmt='d',
            xticklabels=cancer.target_names, yticklabels=cancer.target_names)
plt.show()
```
<img width="510" height="414" alt="image" src="https://github.com/user-attachments/assets/e1b5fe6b-8ad1-4ff2-bdbc-e1cd0a59246c" />

```python
print(classification_report(y_test, test_pred))
```
<img width="388" height="151" alt="image" src="https://github.com/user-attachments/assets/aac866d9-6436-40bc-a948-ce17230d0a03" />

```python
# 테스트 셋에서의 ROC 곡선
RocCurveDisplay.from_estimator(logit, X_test, y_test)
plt.show()
```
<img width="453" height="438" alt="image" src="https://github.com/user-attachments/assets/a39eafef-3846-47e4-905a-0524658c76a4" />

## SGD Classifier

```python
sgd = Pipeline(steps=[('scaler', StandardScaler()),
                      ('clf', SGDClassifier(random_state=42))])
```
```python
sgd.fit(X_train, y_train)
```
<img width="206" height="145" alt="image" src="https://github.com/user-attachments/assets/983bfac1-eed9-4b2b-a7d8-0b7a45c79c49" />

```python
train_pred = sgd.predict(X_train))
```
```python
conf_mat_train = confusion_matrix(y_train, train_pred)
conf_mat_train
```
<img width="148" height="52" alt="image" src="https://github.com/user-attachments/assets/db1d5075-bc56-424f-a688-945f3c0e3069" />

```python
sns.heatmap(data=conf_mat_train, cmap='Blues', annot=True, fmt='d',
            xticklabels=cancer.target_names, yticklabels=cancer.target_names)
plt.show()
```
<img width="533" height="413" alt="image" src="https://github.com/user-attachments/assets/252ed579-2444-42ac-925c-ec39b8ce5043" />

```python
print(classification_report(y_train, train_pred))
```
<img width="387" height="147" alt="image" src="https://github.com/user-attachments/assets/0459b4e3-f52f-4303-8ecf-d9e916999a02" />

```python
test_pred = sgd.predict(X_test)
```
```python
conf_mat_test = confusion_matrix(y_test, test_pred)
conf_mat_test
```
<img width="130" height="43" alt="image" src="https://github.com/user-attachments/assets/5e92677a-8a69-4e47-a24e-82094dd11031" />

```python
sns.heatmap(data=conf_mat_test, cmap='Blues', annot=True, fmt='d',
            xticklabels=cancer.target_names, yticklabels=cancer.target_names)
plt.show()
```
<img width="522" height="416" alt="image" src="https://github.com/user-attachments/assets/d4920447-2bc8-4e7e-97d2-9a3cc32981a1" />

```python
print(classification_report(y_test, test_pred))
```
<img width="384" height="158" alt="image" src="https://github.com/user-attachments/assets/cc8e074f-9f2c-4608-99c0-3ccd40d2b2dc" />

```python
RocCurveDisplay.from_estimator(sgd, X_test, y_test)
plt.show()
```
<img width="455" height="436" alt="image" src="https://github.com/user-attachments/assets/153b2442-4ecc-4db2-9f66-5d6c22518abb" />

# 다중 클래스 분류(multi-class classification)

Iris(붓꽃) 데이터셋에서 setosa/versicolor/virginica 분류

## 데이터 준비

```python
iris = datasets.load_iris(as_frame = True)  # as_frame = True 해주면 iris.frame 이거 가능
```
```python
iris_df = iris.frame
```
```python
iris_df.head()
```
<img width="683" height="195" alt="image" src="https://github.com/user-attachments/assets/fb525b43-5c1d-4e90-9b80-00098b84ef49" />

```python
sns.pairplot(data=iris_df, hue='target')
plt.show()
```
<img width="1059" height="1006" alt="image" src="https://github.com/user-attachments/assets/35fa043e-3854-4c8c-abc3-b83c99151883" />

```python
X = iris.data.values    # 특성 배열
y = iris.target.values      # 타겟 배열
```
```python
# 훈련 셋/테스트 셋 나누기
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 42, stratify = y)
```

## KNN Classifier

```python
knn = Pipeline(steps = [('scaler', StandardScaler()),
                        ('clf', KNeighborsClassifier())])
```
```python
knn.fit(X_train, y_train)
```
<img width="251" height="155" alt="image" src="https://github.com/user-attachments/assets/98e5417a-f86c-4fe0-9a93-f6b224a35b8b" />

```python
train_pred = knn.predict(X_train)
```
```python
cm_train = confusion_matrix(y_train, train_pred)
```
```python
sns.heatmap(data=cm_train, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="510" height="415" alt="image" src="https://github.com/user-attachments/assets/756b216c-5ecb-4ae2-8608-92541be1ea84" />

```python
print(classification_report(y_train, train_pred))
```
<img width="385" height="171" alt="image" src="https://github.com/user-attachments/assets/4b587dbf-6e17-4465-ba62-46480a0f37cd" />

```python
test_pred = knn.predict(X_test)
```
```python
cm_test = confusion_matrix(y_test, test_pred)
```
```python
sns.heatmap(data=cm_test, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="507" height="417" alt="image" src="https://github.com/user-attachments/assets/87ff7609-f34d-49be-adc0-52fd7f088661" />

```python
print(classification_report(y_test, test_pred))
```
<img width="385" height="172" alt="image" src="https://github.com/user-attachments/assets/9f71f510-0335-4a3a-977e-75d60eed160b" />

## Logistic Regression

```python
logit = Pipeline(steps = [('scaler', StandardScaler()),
                          ('clf', LogisticRegression())])
```
```python
logit.fit(X_train, y_train)
```
<img width="242" height="150" alt="image" src="https://github.com/user-attachments/assets/3797049c-c430-4c33-a12d-261a4bd3dcd3" />

```python
train_pred = logit.predict(X_train)
```
```python
cm_train = confusion_matrix(y_train, train_pred)
```
```python
sns.heatmap(data=cm_train, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="513" height="420" alt="image" src="https://github.com/user-attachments/assets/96dcf6e2-d8c9-4187-9c65-fd46ebe12def" />

```python
print(classification_report(y_train, train_pred))
```
<img width="397" height="180" alt="image" src="https://github.com/user-attachments/assets/8145e11e-f176-4907-9ca0-f2115e42028c" />

```python
test_pred = logit.predict(X_test)
```
```python
cm_test = confusion_matrix(y_test, test_pred)
```
```python
sns.heatmap(data=cm_test, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="512" height="425" alt="image" src="https://github.com/user-attachments/assets/18a8ff92-cf48-4045-b3af-11bb3c5e3d46" />

```python
print(classification_report(y_test, test_pred))
```
<img width="386" height="174" alt="image" src="https://github.com/user-attachments/assets/73834b0a-c967-406b-82ea-96b3911c7397" />

## SGD Classifier

```python
sgd = Pipeline(steps=[('scaler', StandardScaler()),
                      ('clf', SGDClassifier())])
```
```python
sgd.fit(X_train, y_train)
```
<img width="220" height="156" alt="image" src="https://github.com/user-attachments/assets/1fa72e92-5aaa-48a3-ad37-5ca1287dcebc" />

```python
train_pred = sgd.predict(X_train)
```
```python
cm_train = confusion_matrix(y_train, train_pred)
```
```python
sns.heatmap(data=cm_train, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="508" height="414" alt="image" src="https://github.com/user-attachments/assets/629e2f76-a13a-4dbc-91d6-e4204074fd1c" />

```python
print(classification_report(y_train, train_pred))
```
<img width="392" height="176" alt="image" src="https://github.com/user-attachments/assets/b5230548-00ef-435d-9e00-2c23d9b9d3db" />

```python
test_pred = sgd.predict(X_test)
```
```python
cm_test = confusion_matrix(y_test, test_pred)
```
```python
sns.heatmap(data=cm_test, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="510" height="417" alt="image" src="https://github.com/user-attachments/assets/6ebd81ef-6d6c-49f7-a7db-6c844b67e7c8" />

```python
print(classification_report(y_test, test_pred))
```
<img width="394" height="184" alt="image" src="https://github.com/user-attachments/assets/28f1f17c-f73b-4c53-a3d5-4e5cfc3fb5c1" />

## SVM Classifier

```python
from sklearn.svm import SVC
```
```python
svc = Pipeline(steps = [('scaler', StandardScaler()),
                        ('clf', SVC())])
```
```python
svc.fit(X_train, y_train)
```
<img width="205" height="152" alt="image" src="https://github.com/user-attachments/assets/bc14efa3-f24b-49c3-b076-c4637ca168cb" />

```python
train_pred = svc.predict(X_train)
```
```python
cm_train = confusion_matrix(y_train, train_pred)
```
```python
sns.heatmap(data=cm_train, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="510" height="417" alt="image" src="https://github.com/user-attachments/assets/260cc891-1006-415c-a422-d4b4bb00a2b9" />

```python
print(classification_report(y_train, train_pred))
```
<img width="390" height="171" alt="image" src="https://github.com/user-attachments/assets/64a79e03-5e25-4bb2-bda8-fa1784e89c41" />

```python
test_pred = svc.predict(X_test)
```
```python
cm_test = confusion_matrix(y_test, test_pred)
```
```python
sns.heatmap(data=cm_test, cmap='Blues', annot=True, fmt='d',
            xticklabels=iris.target_names, yticklabels=iris.target_names)
plt.show()
```
<img width="510" height="424" alt="image" src="https://github.com/user-attachments/assets/10f12a7e-0808-40af-b999-d825b60a181d" />

```python
print(classification_report(y_test, test_pred))
```
<img width="393" height="172" alt="image" src="https://github.com/user-attachments/assets/082b25fc-20da-45a0-b665-e005db1f557f" />
