# Ex2. mpg 데이터셋<br>

- seaborn 패키지의 예제 데이터 셋 'mpg'를 로드해서 DataFrame 생성<br>
- DataFrame 탐색 - 출력, 요약 정보, 숫자 타입 기술 통계량, 카테고리 타입 빈도수
  
- 산점도

    - mpg(연비) ~ displacement(배기량)<br>
    - 2x2 모양의 subplot을 생성<br>
        - mpg ~ cylinders(실린더 개수)<br>
        - mpg ~ horsepower(마력)<br>
        - mpg ~ weight(무게)<br>
        - mpg ~ acceleration(가속도)<br>
- 빈도수 막대 그래프<br>
    - cyliners 빈도수<br>
    - origin(자동차 생산 지역) 빈도수<br>
    - model_year(자동차 생산 연도) 빈도수<br>
        - 선 그래프 가능?<br>
    - origin 별, cylinders 별 빈도수<br>
- 통계량 막대 그래프 - 2개의 subplot 생성<br>
     - cylinders 별 mpg의 중앙값(median)<br>
     - origin 별 mpg의 중앙값<br>
- Box plot<br>
     - 3개의 subplot을 생성<br>
        - mpg, displacement, weight box plot<br>
     - origin 별 mpg box plot<br>
- Histogram<br>
      - 4개의 subplot을 생성<br>
        - mpg, displacement, weight, model_year histogram<br>
- Pair plot<br>

## 데이터셋 준비
```python
# mpg(mile per gallon): 자동차 연비 단비. km/L.
# seaborn 패키지의 예제 데이터 셋 'mpg'를 로드해서 DataFrame 생성
mpg = sns.load_dataset('mpg')
```
```python
# DataFrame 탐색 - 출력, 요약 정보, 숫자 타입 기술 통계량, 카테고리 타입 빈도수
mpg.info()
```
![image](https://github.com/user-attachments/assets/ae2f04d9-00c4-4046-94d4-25a53c4b7e45)

```python
mpg.head()
```
![image](https://github.com/user-attachments/assets/bfc0d6f4-4a2c-44be-bed8-c78ba8e7f63f)

```python
mpg.tail()
```
![image](https://github.com/user-attachments/assets/3b627655-0e06-449c-b369-d971b28c238d)

```python
# 숫자 타입 변수들의 기술 통계량
mpg.describe()
```
![image](https://github.com/user-attachments/assets/7c70269d-f706-4e95-b617-e8c8b19c5a06)

```python
mpg.origin.value_counts()
```
![image](https://github.com/user-attachments/assets/49180e07-cef5-4d95-83f0-4e94584438fd)

```python
mpg.name.value_counts()
```
![image](https://github.com/user-attachments/assets/e5b5411d-3978-4d11-91ed-99526aa950bd)

```python
mpg.cylinders.value_counts()
```
![image](https://github.com/user-attachments/assets/260a5519-0c6d-4d49-9f7d-7c34b9fcda51)

```python
mpg.model_year.value_counts()
```
![image](https://github.com/user-attachments/assets/c173dd7f-06ac-4621-a3b5-521d7602bc5a)

## 산점도(Scatter plot)
```python
# mpg(연비) ~ displacement(배기량)
# 알고 싶은거. 관심 있는 걸 y에 놓기
sns.scatterplot(data = mpg, x = 'displacement', y = 'mpg')
plt.show()
```
![image](https://github.com/user-attachments/assets/dc75bca4-a4bb-461f-842c-3f81b50b18ad)

```python
sns.regplot(data = mpg, x = 'displacement', y = 'mpg',
            scatter_kws = {'alpha': 0.4}, line_kws = {'color': 'IndianRed'})
plt.show()
```
![image](https://github.com/user-attachments/assets/c2237414-dcc5-44d1-bfd3-c2274b86c7f7)

```python
# 2x2 Axes를 생성하고, 산점도 그리기
fig, axes = plt.subplots(nrows = 2, ncols = 2, figsize = (12, 8))
# print(axes)   # 2차원 ndarray

sns.scatterplot(data = mpg, x = 'cylinders', y = 'mpg', ax = axes[0][0])
sns.scatterplot(data = mpg, x = 'horsepower', y = 'mpg', ax = axes[0][1])
sns.scatterplot(data = mpg, x = 'weight', y = 'mpg', ax = axes[1][0])
sns.scatterplot(data = mpg, x = 'acceleration', y = 'mpg', ax = axes[1][1])

plt.show()
```
![image](https://github.com/user-attachments/assets/da76bfc1-bdda-411d-ab70-3605fbcefa85)

```python
# 상관계수(correlation coefficient)
# pd.DataFrame.corr() 메서드의 method 파라미터: 상관계수를 계산하는 방법(pearson, kendall, spearman)
mpg[['mpg', 'displacement', 'horsepower', 'weight', 'acceleration']].corr()
```
![image](https://github.com/user-attachments/assets/57684586-1c44-42cd-be2a-22ebccca80c0)

```python
mpg[['mpg', 'displacement', 'horsepower', 'weight', 'acceleration']].corr(method = 'spearman')
```
![image](https://github.com/user-attachments/assets/f9caad1f-e185-4726-8218-aace95486f87)

### 지역, 실린더 개수를 산점도에 표현
```python
# 지역이 연비에 영향을 미칠까
sns.scatterplot(data = mpg, x = 'displacement', y = 'mpg', hue = 'origin')
plt.show()
```
![image](https://github.com/user-attachments/assets/0cdba383-0f7a-4e25-9ef6-c92a74c35186)

```python
sns.scatterplot(data = mpg, x = 'displacement', y = 'mpg', hue = 'origin', style = 'cylinders')
plt.show()
```
![image](https://github.com/user-attachments/assets/abea08c9-2e84-4879-85fd-a152ec2b16f5)

```python
fig = px.scatter(data_frame = mpg, x = 'displacement', y = 'mpg', color = 'origin', symbol = 'cylinders')
fig.show()
```
![image](https://github.com/user-attachments/assets/2f14f253-ec92-4d1b-85a7-77aaefe398ce)

## count plot
```python
sns.countplot(data = mpg, x = 'cylinders')
plt.show()
```
![image](https://github.com/user-attachments/assets/d8f485f6-4f46-4157-bbba-5db9f5f57f70)

```python
sns.countplot(data = mpg, x = 'origin')
plt.show()
```
![image](https://github.com/user-attachments/assets/eea5987d-41b5-4761-9526-bba392ff731c)

```python
sns.countplot(data = mpg, x = 'model_year')
plt.show()
```
![image](https://github.com/user-attachments/assets/70363878-531e-4a11-82e8-8b4572a98fda)

## line plot
```python
year_count = mpg.model_year.value_counts().sort_index()
year_count
```
![image](https://github.com/user-attachments/assets/6cbefec4-c117-4c40-ae13-5c7a975f4755)

```python
plt.plot(year_count.index, year_count.values, 'bo-')
plt.show()
```
![image](https://github.com/user-attachments/assets/a9dbc559-6ad1-48e6-b224-53420ec0f22f)

```python
sns.lineplot(data = mpg, x = 'model_year', y = 'mpg', estimator = 'size', marker = 'o')
plt.show()
```
![image](https://github.com/user-attachments/assets/4d7247bc-90d4-4332-9b05-a985781a8968)

```python
sns.lineplot(y = year_count, x = year_count.index)
plt.show()
```
![image](https://github.com/user-attachments/assets/a7ac1fb7-53e1-4ca9-acb4-c4fce9b5c3b7)

```python
sns.countplot(data = mpg, x = 'cylinders', hue = 'origin')
plt.show()
```
![image](https://github.com/user-attachments/assets/b840b35a-3b6d-4ca4-ac5a-2f9198928d2e)

```python
sns.catplot(data = mpg, x = 'cylinders', kind = 'count', col = 'origin')
plt.show()
```
![image](https://github.com/user-attachments/assets/54e01e91-0b5b-4fac-a53b-30699d7027bf)

## bar plot
```python
# 실린더 개수별 연비 중위값
sns.barplot(data = mpg, x = 'cylinders', y = 'mpg', estimator = 'median', errorbar = None)
plt.show()
```
![image](https://github.com/user-attachments/assets/e9894fa5-02e2-46db-9021-ad6f7256227c)

```python
mpg.groupby(by = ['cylinders']).mpg.median()
```
![image](https://github.com/user-attachments/assets/931a084f-4830-45b6-ba20-e08de092e1bb)

```python
# 지역별 연비 중위값
sns.barplot(data = mpg, x = 'origin', y = 'mpg', estimator = 'median', errorbar = None)
plt.show()
```
![image](https://github.com/user-attachments/assets/378ae690-004d-49a7-8500-5023d2ef5204)

```python
mpg.groupby(by = ['origin']).mpg.median()
```
![image](https://github.com/user-attachments/assets/e2401ab7-afe7-479e-b58c-42f3a2a843b9)

```python
mpg.groupby(by = ['origin', 'cylinders'], observed = True).mpg.median()
```
![image](https://github.com/user-attachments/assets/fe0e6576-afc8-45f7-8125-17368286f147)

```python
sns.barplot(data = mpg, x = 'cylinders', y = 'mpg', hue = 'origin', estimator = 'median')
plt.show()
```
![image](https://github.com/user-attachments/assets/42f3b571-314d-4d18-9e92-a5a8c3f795df)

```python
sns.catplot(data = mpg, x = 'cylinders', y = 'mpg', kind = 'bar', estimator = 'median', col = 'origin')
plt.show()
```
![image](https://github.com/user-attachments/assets/cf3fa055-8ad4-4219-97b4-0d6a34bb6239)

## box plot
```python
fig, axes = plt.subplots(ncols = 3, figsize = (15, 4))

sns.boxplot(data = mpg, y = 'mpg', ax = axes[0])
sns.boxplot(data = mpg, y = 'displacement', ax = axes[1])
sns.boxplot(data = mpg, y = 'weight', ax = axes[2])

plt.show()
```
![image](https://github.com/user-attachments/assets/b73102d0-251a-4899-a510-85bf7d9278eb)

```python
# 반복문 사용
fig, axes = plt.subplots(ncols = 3, figsize = (15, 4))

# print(mpg.columns[[0, 2, 4]])

columns = mpg.columns[[0, 2, 4]]
for i, c in enumerate(columns):
    sns.boxplot(data = mpg, y = c, ax = axes[i])

plt.show()
```
![image](https://github.com/user-attachments/assets/43356daa-887e-465b-8dfd-47cade387d70)

### 지역별 mpg의 box plot
```python
sns.boxplot(data = mpg, x = 'origin', y = 'mpg')
plt.show()
```
![image](https://github.com/user-attachments/assets/d1bc04ae-b311-4229-8696-5ad7b6e50122)

```python
sns.boxplot(data = mpg, x = 'cylinders', y = 'mpg')
plt.show()
```
![image](https://github.com/user-attachments/assets/6566a843-2ef7-4bba-9514-0904a9425659)

```python
sns.catplot(data = mpg, x = 'cylinders', y = 'mpg', kind = 'box', col = 'origin')  
plt.show()
```
![image](https://github.com/user-attachments/assets/cf80c750-aab1-483f-aea6-53b2c0454da6)

```python
sns.catplot(data = mpg, x = 'cylinders', y = 'mpg', col = 'origin')  # kind = 'strip' 기본값
plt.show()
```
![image](https://github.com/user-attachments/assets/2048e5aa-2d96-46bf-8049-0c44ef2617f1)

```python
mpg.groupby(by = ['origin', 'cylinders']).mpg.describe()
```
![image](https://github.com/user-attachments/assets/88046821-dd8d-478c-b486-d671536ba32d)

## histogram
```python
fig, axes = plt.subplots(nrows = 2, ncols = 2, figsize = (8, 8))

sns.histplot(data = mpg, x = 'mpg', ax = axes[0][0])
sns.histplot(data = mpg, x = 'displacement', ax = axes[0][1])
sns.histplot(data = mpg, x = 'weight', ax = axes[1][0])
sns.histplot(data = mpg, x = 'model_year', ax = axes[1][1], bins = np.arange(70, 83))

plt.show()
```

![image](https://github.com/user-attachments/assets/55d9b0e3-8e6b-4f8e-a488-555407103abd)

## pair plot
```python
sns.pairplot(data = mpg)
plt.show()
```
![image](https://github.com/user-attachments/assets/dcd1cd02-1813-4812-b730-09bad151576a)

```python
sns.pairplot(data = mpg, vars = ['mpg', 'displacement', 'horsepower', 'weight'], hue = 'origin')
plt.show()
```
![image](https://github.com/user-attachments/assets/0168f1bf-4abc-40b6-8f99-b988625174e1)

<br>

<참고 사이트>
https://github.com/wesm/pydata-book

<br>

- 데이터 다운 받기<br>
깃허브 데이터 -> raw -> 주소복사 -> 변수에 주소 넣기<br>
- 엑셀 파일 다운로드<br>
raw에서 오른쪽 클릭 -> 링크 복사

<br>

# 파일을 읽고 DataFrame 생성

*   csv(comma-separated values), tsv(tab-seprated values)
*   txt
*   xls, xlsx

# csv 파일의 첫번째 행이 컬럼 이름(인덱스)인 경우
```python
ex1_path = 'https://raw.githubusercontent.com/wesm/pydata-book/refs/heads/3rd-edition/examples/ex1.csv'
ex1_df = pd.read_csv(ex1_path)
ex1_df
```
![image](https://github.com/user-attachments/assets/661b62bb-c988-4fd8-8788-289d2eeca8db)

```python
ex1_df.info()
```
![image](https://github.com/user-attachments/assets/f563dcd5-397d-4f4f-bfca-d9163cca99a7)

```python
ex1_df.describe()
```
![image](https://github.com/user-attachments/assets/c9741021-7c88-4d8d-997e-a1cf20589d90)

# csv 파일의 첫번째 행부터 데이터인 경우
<br>
csv 파일에 컬럼 이름에 대한 정보가 없는 경우

```python
ex2_path = 'https://raw.githubusercontent.com/wesm/pydata-book/refs/heads/3rd-edition/examples/ex2.csv'
ex2_df = pd.read_csv(ex2_path, names = ['A', 'B', 'C', 'D', 'MSG'])
ex2_df
```
![image](https://github.com/user-attachments/assets/008f2a2c-0661-4b12-9ec7-9d471ce4c362)

```python
ex2_df.info()
```
![image](https://github.com/user-attachments/assets/377925a9-ca63-4c35-a0f5-19092de2412a)

```python
# csv 파일에 컬럼 이름(헤더)가 있지만, 컬럼 이름들을 재지정할 때
ex1_df = pd.read_csv(ex1_path, names = ['kor', 'eng', 'math', 'sci', 'msg'], header = 0)
ex1_df
```
![image](https://github.com/user-attachments/assets/798cb922-0090-4b14-885d-b1f7cf0240cd)

# 값들이 공백('\s', '\t')으로 구분된 파일
```python
ex3_path = 'https://raw.githubusercontent.com/wesm/pydata-book/refs/heads/3rd-edition/examples/ex3.txt'
ex3_df = pd.read_csv(ex3_path, sep = '\s+')  # 공백이 하나 이상
ex3_df  # 행 인덱스도 잘 찾고 있다
```
![image](https://github.com/user-attachments/assets/6f1eacf6-a73f-45c8-9069-d36f383553cf)

```python
ex3_df.info()
```
![image](https://github.com/user-attachments/assets/702d373c-c2d7-4a37-b0f2-fd00e4fa0a12)

```python
ex3_df.loc['aaa']
```
![image](https://github.com/user-attachments/assets/02f34eb0-82ca-46bf-9586-4f31d7dc59ea)

```python
ex3_df.loc['aaa':'ccc']
```
![image](https://github.com/user-attachments/assets/4d267672-e53b-442a-a30d-4ad854bbb684)

# 컬럼 헤더와 데이터 이외의 주석 등을 가지고 포함한 csv 파일
```python
ex4_path = 'https://raw.githubusercontent.com/wesm/pydata-book/refs/heads/3rd-edition/examples/ex4.csv'
ex4_df = pd.read_csv(ex4_path, skiprows = [0, 2, 3])
# skiprows: int, list of int. 읽지 않고 건너 뛸 줄 번호(들의 리스트)
ex4_df
```
![image](https://github.com/user-attachments/assets/eb6d1dfd-1c3f-49a9-8518-7c6217e3fd62)

# NA 또는 빈 문자열이 포함된 csv 파일
```python
ex5_path = 'https://raw.githubusercontent.com/wesm/pydata-book/refs/heads/3rd-edition/examples/ex5.csv'
ex5_df = pd.read_csv(ex5_path)
ex5_df
```
![image](https://github.com/user-attachments/assets/0b0f64e4-d54f-4d24-9fb0-a696f4ce8c8c)

```
read_csv 함수는 csv 파일에서 'NA', 'NAN', 'na', 'nan' 등의 문자열을 Null(값 없음)로 취급함.

비어 있는 값(comma 사이에 아무 문자열도 없는 경우)도 Null로 취급함.
```
```python
ex5_df.info()
```
![image](https://github.com/user-attachments/assets/a149d542-9380-4910-ab11-37bb68ca4e40)

# 값들이 따옴표("")로 감싸여져 있는 csv 파일
```python
ex7_path = 'https://raw.githubusercontent.com/wesm/pydata-book/refs/heads/3rd-edition/examples/ex7.csv'
ex7_df = pd.read_csv(ex7_path)
ex7_df
```
![image](https://github.com/user-attachments/assets/25bb847b-7ad7-4b9d-a34f-372d8406ccce)

```python
ex7_df.info()
# 따옴표(인용부호) 안의 문자열이 숫자(int, float)로 변환 가능한 경우에는 자동으로 타입 변환을 수행함.
```
![image](https://github.com/user-attachments/assets/97143f2e-31ff-488a-a8d6-30523d6cae6d)

```
csv 파일 읽기 --> DataFrame: pd.read_csv()
DataFrame --> csv 파일 쓰기: pd.DataFrame.to_csv()
```
```python
df = pd.DataFrame(data = {
    'day': [1, 2, 3],
    'price': [0.5, 1.1, 0.9]
})
df
```
![image](https://github.com/user-attachments/assets/99af01d5-36f3-4f68-adcb-94edbdde8519)

```python
df.to_csv('test_df.csv')
```
# 엑셀 파일 읽기

```python
file_path = 'https://github.com/wesm/pydata-book/raw/refs/heads/3rd-edition/examples/ex1.xlsx'
excel_df = pd.read_excel(file_path)
excel_df
```
![image](https://github.com/user-attachments/assets/e373cf0f-89d8-40f1-899b-9817f836723f)

```python
excel_df2 = pd.read_excel(file_path, index_col = 0)
excel_df2
```
![image](https://github.com/user-attachments/assets/68d05501-00f7-4ff9-a6ba-4a377bde3b08)
