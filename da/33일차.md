![image](https://github.com/user-attachments/assets/e777042f-bfdf-4297-9f4e-28ddb39f8036)# gapminder.tsv 파일 데이터 분석

## 필요한 모듈 import
```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
```
# DataFrame 생성
```python
gap_path = 'https://raw.githubusercontent.com/JakeOh/202505_BD50/refs/heads/main/datasets/gapminder.tsv'
gap_df = pd.read_csv(gap_path, sep = '\t')
gap_df.head()
```
![image](https://github.com/user-attachments/assets/f242e448-c8e6-43a5-986b-0bd326012d09)

```python
gap_df.tail()
```
![image](https://github.com/user-attachments/assets/102c3371-b949-4d1e-a544-8a783b77f11d)

```python
gap_df.info()
```
![image](https://github.com/user-attachments/assets/9d0d3fc7-12bd-4e4a-b723-6980f19e443c)

```python
gap_df.describe()
```
![image](https://github.com/user-attachments/assets/f45eaaa5-0f7c-446e-8e22-1ffc3868b0e7)

# 국가 수
```python
# 테이블에는 모두 몇 개의 나라가 있을까요?
gap_df.country.value_counts()
```
![image](https://github.com/user-attachments/assets/d8af51f6-2f12-4570-a890-2541735efe7e)

```python
# 풀이 1
countries = gap_df.country.unique()  # 국가 이름들을 저장하는 np.ndarray
# countries 결과는 배열
len(countries)
```
![image](https://github.com/user-attachments/assets/227cb6b0-de32-407b-a54f-349fe97debec)

```python
# 풀이 3
countries.size
```
![image](https://github.com/user-attachments/assets/b65de9a4-0a77-4499-b3c6-5cbbe3b30971)

# 대륙 수
```python
# 테이블에는 모두 몇 개의 대륙이 있을까요?
gap_df.continent.value_counts()  # value_counts는 알파벳 순서 아님
```
![image](https://github.com/user-attachments/assets/1b6f0710-ae7f-4738-b214-69a780c87efb)

```python
# 풀이 2
continents = gap_df.continent.unique()
continents
```
![image](https://github.com/user-attachments/assets/cf637aa5-1303-4372-9c9d-4f3999f8fce6)

```python
sns.countplot(data = gap_df, x = 'continent', hue = 'continent')
plt.show()
```
![image](https://github.com/user-attachments/assets/bb9bd587-c865-4d9e-aa47-21fc85a99c3f)

# 연도 분석
```python
# 테이블에는 저장된 데이터는 몇년도부터 몇년도까지 조사한 내용일까요?
yy = gap_df.year.sort_values()
print(yy.head(n = 1))
print(yy.tail(1))
```
![image](https://github.com/user-attachments/assets/36eb70fc-139a-42c5-80c1-a9a1a406b4ff)

```python
# 풀이 1
gap_df.year.describe()
```
![image](https://github.com/user-attachments/assets/e3ab70a8-be5a-4f41-8d5c-0355f66f2693)

```python
# 풀이 2
years = gap_df.year.unique()
print(years)
print(years.size)
```
![image](https://github.com/user-attachments/assets/9fe96933-b0f5-40c6-bfe1-a50b5a7e4244)

```python
# 풀이 3
gap_df.year.value_counts()
```
![image](https://github.com/user-attachments/assets/53a9f743-6d38-4fe4-b26a-507806a41c1c)

# 기대수명 분석

```python
# 기대 수명이 최댓값인 레코드(row)를 찾으세요.
gap_df[gap_df.lifeExp == gap_df.lifeExp.max()]
```
![image](https://github.com/user-attachments/assets/a0434841-4e7c-4bc6-a1cd-aca87396a7e6)

```python
# 기대수명 최솟값
gap_df[gap_df.lifeExp == gap_df.lifeExp.min()]
```
![image](https://github.com/user-attachments/assets/9ee75f40-cae9-4d93-a56b-d24482e9fa0e)

## 일본의 연도별 기대수명

```python
japan_df = gap_df[gap_df.country == 'Japan']
japan_df
```
![image](https://github.com/user-attachments/assets/6614eb90-d2f7-49d3-a271-16dd53ae77cd)

```python
sns.lineplot(data = japan_df, x = 'year', y = 'lifeExp')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/be20dd36-8482-4e6e-82a7-f856e163cdbf)

```python
sns.barplot(data = japan_df, x = 'year', y = 'lifeExp', errorbar = None)
plt.show()
```
![image](https://github.com/user-attachments/assets/3b6c1b02-27bc-4f0d-985b-05550911cff1)

## 르완다의 연도별 기대수명

```python
rwanda_df = gap_df[gap_df.country == 'Rwanda']
rwanda_df
```

![image](https://github.com/user-attachments/assets/ca196523-0148-4e43-95a1-787675e7ae1f)

```python
sns.lineplot(data = rwanda_df, x = 'year', y = 'lifeExp', marker = 'o')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/ca43a5a5-deb3-451f-93e9-2a9883a0a737)

## 연도별 기대수명 평균값
```python
gap_df.groupby(by = ['year']).lifeExp.mean()
```
![image](https://github.com/user-attachments/assets/9c9da8d5-3f1f-4326-a060-0c263c1d1221)

```python
sns.lineplot(data = gap_df, x = 'year', y = 'lifeExp', estimator = 'mean', marker = 'o', errorbar = None) # estimator 생략 가능
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/685b358a-253b-4767-88b7-7d22d0bcad23)

```python
sns.barplot(data = gap_df, x = 'year', y = 'lifeExp', estimator = 'mean', errorbar = None)
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/76b15134-bb95-4c04-8404-243f5695c17c)

## 대률별 기대수명 평균의 (연도에 따른)변화
```python
gap_df.groupby(by = ['continent', 'year']).lifeExp.mean()
```
![image](https://github.com/user-attachments/assets/a2d41fa3-2a50-46f1-bed0-28c071716ee9)

```python
sns.lineplot(data = gap_df, x = 'year', y = 'lifeExp', hue = 'continent', errorbar = None) # estimator = 'mean' 생략 가능
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/c962653b-d0d0-4c9e-a8da-68624c5085ba)

# 아프리카 대륙의 기대수명
```python
# 남아프리카 대륙의 국가 5개
southern_africa = ['Botswana', 'Namibia', 'South Africa', 'Zambia', 'Zimbabwe']
southern_africa_df = gap_df[gap_df.country.isin(southern_africa)]   # gap_df에서 country 컬럼의 값이 southern_africa랑 같으면 True
```

```python
southern_africa_df.head()
```
![image](https://github.com/user-attachments/assets/c6abc0d5-6c54-4398-b133-113277b77024)

```python
southern_africa_df.tail()
```
![image](https://github.com/user-attachments/assets/2ed5262c-2e9a-4b4a-8d85-8adb123546b9)

```python
sns.lineplot(data = southern_africa_df, x = 'year', y = 'lifeExp', hue = 'country')
plt.grid()
plt.show()
# 전염병 예상 가능한 그래프
```
![image](https://github.com/user-attachments/assets/13db80f2-b024-4518-b928-65876ee1b230)

```python
# 북아프리카 지역의 5개 국가
nothern_africa = ['Algeria', 'Egypt', 'Libya', 'Morocco', 'Sudan']
nothern_africa_df = gap_df[gap_df.country.isin(nothern_africa)]
```

```python
nothern_africa_df.head()
```
![image](https://github.com/user-attachments/assets/65c79c23-e6a5-4d18-a949-fd5583573069)

```python
nothern_africa_df.tail()
```
![image](https://github.com/user-attachments/assets/2c0b8ba0-babf-4c21-8217-5a972cec1635)

```python
sns.lineplot(data = nothern_africa_df, x = 'year', y = 'lifeExp', hue = 'country')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/61fce10a-d778-4feb-82f7-67f99fa9c439)

# 인구분석

```python
# 인구가 최댓값인 레코드(row)를 찾으세요.
gap_df[gap_df['pop'] == gap_df['pop'].max()]
```
![image](https://github.com/user-attachments/assets/95853d41-6c81-4a52-b55c-18359973ac72)

## 대륙별 인구 변화

```python
gap_df.groupby(by = ['continent', 'year'])['pop'].sum()
```
![image](https://github.com/user-attachments/assets/32bf534d-5dbc-42ba-bc0f-ce756bcba35b)

```python
sns.lineplot(data = gap_df, x = 'year', y = 'pop', hue = 'continent', estimator = 'sum', errorbar = None)
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/1998136d-09ec-48af-827e-e268f95f26b6)

## 아시아 대륙을 제외한 대륙들의 인구 변화

```python
# (위에 그래프에서 다른 그래프들이 잘 안보여서 밑에 그래프만 보기)
sns.lineplot(data = gap_df[gap_df.continent != 'Asia'],
              x = 'year', y = 'pop', hue = 'continent',
              estimator = 'sum', errorbar = None)
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/4e743d96-ba67-42d3-a91d-6a1f2a7ceab3)

# 1인당 GDP 분석

## 1인당 GDP 최댓값, 최솟값

```python
# 풀이
gap_df[(gap_df.gdpPercap == gap_df.gdpPercap.max()) |
       (gap_df.gdpPercap == gap_df.gdpPercap.min())]
```
![image](https://github.com/user-attachments/assets/0815c11f-756a-4dd6-966c-6d9a0d36dd57)

## 쿠웨이트의 1인당 GDP 변화

```python
kuwait_df = gap_df[gap_df.country == 'Kuwait']
sns.lineplot(data = kuwait_df, x = 'year', y = 'gdpPercap', errorbar = None, marker = 'o')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/7f44b5c5-4469-4730-be23-f8485554ad53)

## 콩고의 1인당 GDP 변화

```python
congo_df = gap_df[gap_df.country == 'Congo, Dem. Rep.']
sns.lineplot(data = congo_df, x = 'year', y = 'gdpPercap', errorbar = None, marker = 'o')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/efbfb8ce-1537-40f2-b490-dbd6cf3e2f72)

## 산유국들의 1인당GDP 변화

```python
oil_countries = ['Saudi Arabia', 'Iraq', 'Iran', 'Kuwait']
oil_df = gap_df[gap_df.country.isin(oil_countries)]

sns.lineplot(data = oil_df, x = 'year', y = 'gdpPercap', hue = 'country')
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/439a09cf-98b5-49ef-acf7-074626ff91bb)

## G7 국가들의 1인당GDP 변화

```python
g7_countries = ['United States', 'Germany', 'United Kindom', 'France']
g7_df = gap_df[gap_df.country.isin(g7_countries)]

sns.lineplot(data = g7_df, x = 'year', y = 'gdpPercap', errorbar = None, marker = 'o')

plt.grid()
plt.show()
```

![image](https://github.com/user-attachments/assets/2e29e1a5-e885-4187-afdb-aa6e4fe633b7)

## 대륙별 1인당GDP 평균의 변화

<br>
- 대륙별 빈부격차가 있을까?

```python
gap_df.groupby(by = ['continent', 'year']).gdpPercap.mean()
```
![image](https://github.com/user-attachments/assets/6c23f3bb-edfa-4ff2-b82f-e84a708b9bbd)

```python
sns.lineplot(data = gap_df, x = 'year', y = 'gdpPercap', hue = 'continent', errorbar=None)
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/3b64b3ff-ab92-40c6-af2f-3484199bca83)

## 2007년 1인당GDP 상위 10개 국가, 하위 10개 국가

```python
top10_gdp = gap_df[gap_df.year == 2007].sort_values(by = 'gdpPercap', ascending = False).head(n = 10)
top10_gdp
```
![image](https://github.com/user-attachments/assets/00b79dbe-6a08-4701-8a86-aac696858897)

```python
# 순위는 막대그래프가 좋음
sns.barplot(data = top10_gdp, x = 'gdpPercap', y = 'country', errorbar = None, hue = 'country')
plt.show()
```
![image](https://github.com/user-attachments/assets/983bdf95-9e13-4042-8f2f-128de762b797)

```python
low10_gdp = gap_df[gap_df.year == 2007].sort_values(by = 'gdpPercap').head(n = 10)
low10_gdp
```
![image](https://github.com/user-attachments/assets/68af4ce4-8a1a-4d49-9646-fd9e3bf06ee6)

```python
sns.barplot(data = low10_gdp, x = 'gdpPercap', y = 'country', hue = 'country')
plt.show()
```
![image](https://github.com/user-attachments/assets/a48974ae-43bb-4e85-8e77-376b120e8494)

## 한국, 중국, 일본 1인당GDP 변화

```python
kcj = ['Korea, Rep.', 'China', 'Japan']
kcj_df = gap_df[gap_df.country.isin(kcj)]
```
```python
kcj_df.head()
```
![image](https://github.com/user-attachments/assets/a7772660-9982-4ccd-accc-6c8629969629)

```python
kcj_df.tail()
```
![image](https://github.com/user-attachments/assets/fe3ed04b-1fa1-4dff-9825-e3dcf72e238f)

```python
# sns.lineplot(data = kcj_df, x = 'year', y = 'gdpPercap', hue = 'country') # style이 반드시 들어가야 markers가 들어갈 수 있음
sns.lineplot(data = kcj_df, x = 'year', y = 'gdpPercap', hue = 'country', style = 'country', markers = True)
plt.grid()
plt.show()
```
![image](https://github.com/user-attachments/assets/40be89b1-1b45-4cc1-b1ee-ce8646ed0011)

# 상관 관계

```python
sns.pairplot(data = gap_df)
plt.show()
```
![image](https://github.com/user-attachments/assets/2fb48ffa-2d0e-4780-8da2-94e06dfa3315)

```python
gap_df[['year', 'lifeExp', 'pop', 'gdpPercap']].corr()
```
![image](https://github.com/user-attachments/assets/72372066-19cf-4722-b34e-7842ab410fdc)

## 2007년 자료에서 상관 관계
```python
df_2007 = gap_df[gap_df.year == 2007]

df_2007
```
![image](https://github.com/user-attachments/assets/41238384-25f3-43a1-bd5e-16033184ae2b)

```python
sns.pairplot(data = df_2007[['lifeExp', 'pop', 'gdpPercap']])
plt.show()
```
![image](https://github.com/user-attachments/assets/d8315408-09aa-45e6-86fd-77997b3b9969)

```python
df_2007[['lifeExp', 'pop', 'gdpPercap']].corr()
```
![image](https://github.com/user-attachments/assets/f5588a19-32d7-488b-aae8-1626f02c8a4b)

```python
# 2007년 자료에서 lifeExp ~ gdpPercap
sns.scatterplot(data = df_2007, x = 'gdpPercap', y = 'lifeExp', hue = 'continent',
                size = 'popk')
plt.show()
```
![image](https://github.com/user-attachments/assets/55c63c97-a7bf-4aee-b46a-546f7c5e900f)

### 문자열 컬럼(변수) 다루기

```python
gap_df.country.unique()
```
![image](https://github.com/user-attachments/assets/94f0204c-1f38-4849-bba5-9055973658c6)

```python
'Korea, Rep.'.lower().find('kor')
```
![image](https://github.com/user-attachments/assets/c64bada0-5b2d-4506-9d0f-5d78a8ffb00d)

```python
gap_df.country.str.lower().str.contains('kor')
```
![image](https://github.com/user-attachments/assets/2fe4b9af-05aa-49de-aff0-07d82d5a1581)

```python
gap_df[gap_df.country.str.lower().str.contains('kor')]
```
![image](https://github.com/user-attachments/assets/008cc1a6-1990-4345-876e-af8120682692)

```python
gap_df.dtypes
```
![image](https://github.com/user-attachments/assets/cedf8b14-5a26-47ab-87b4-89d2f89bdd11)

# DataFrame에서 문자열 변수(컬럼) 다루기

# mpg 데이터셋

```python
mpg = sns.load_dataset('mpg')
```
```python
mpg.head()
```
![image](https://github.com/user-attachments/assets/003a5435-b51a-479c-ae90-acffc481d4af)

```python
mpg.info()
```
![image](https://github.com/user-attachments/assets/d76fc616-1c3d-4441-86c5-bec0238c5be6)

- mpg 데이터프레임에 company 이름의 파생변수(컬럼)를 추가.<br>
- company 컬럼의 값은 name 컬럼의 첫번째 단어를 저장.<br>

```python
mpg.name.str.split()    # split 기본 값은 공백
```
![image](https://github.com/user-attachments/assets/aa3e47e8-87c5-4adf-9ef0-7c028dab92cf)

```python
mpg.name.str.split().str[0]
```
![image](https://github.com/user-attachments/assets/b67ba5fd-32ff-4ee7-85af-f30f08c1baa1)

```python
mpg['company'] = mpg.name.str.split().str[0]

mpg.head()
```
![image](https://github.com/user-attachments/assets/d580251e-77af-4d50-9abb-e3a82b4aa875)

```python
mpg.tail()
```
![image](https://github.com/user-attachments/assets/4699464a-17f2-459e-958d-c35ca0e5a4da)

```python
companies = mpg.company.unique()
companies
```
![image](https://github.com/user-attachments/assets/43b8296e-55d0-4c41-a798-039035c2452b)

```python
companies.sort()
companies
```
![image](https://github.com/user-attachments/assets/2b2a5be0-2b06-4861-8473-820767bb9ab8)

```python
companies.size
```
![image](https://github.com/user-attachments/assets/86676d1c-7fcb-4d7e-a2ba-73c5a4ad2299)
